(()=>{"use strict";var e={},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}function r(e,t){if(void 0===e)throw TypeError("attempted to "+t+" private static field before its declaration")}function i(e,t,n){return a(e,t),r(n,"get"),n.get?n.get.call(e):n.value}n.rv=()=>"1.2.7",n.ruid="bundler=rspack@1.2.7";function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(e!==t)throw TypeError("Private static access of wrong provenance")}var s=function(){var e;function t(e,n){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t),o(this,"vertices",void 0),o(this,"indices",void 0),o(this,"vertixCount",void 0),o(this,"triangleCount",void 0),this.vertices=e,this.indices=n,this.vertixCount=e.length/8,this.triangleCount=n.length/3}return e=[{key:"sphere",get:function(){if(null===i(this,t,u)){var e;e=t.createSphere(),a(this,t),r(u,"set"),function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw TypeError("attempted to set read only private field");t.value=n}}(this,u,e)}return i(this,t,u)}},{key:"createSphere",value:function(){for(var e=Math.sin(Math.PI/4),n=Array(10),r=Math.PI/44,i=r,o=0;o<10;o++,i+=r)n[o]={cos:Math.cos(i),sin:Math.sin(i)};for(var a=Array(43),s=0;s<43;s++)a[s]=Array(89);a[21][0]={x:1,y:0,z:0},a[21][11]={x:e,y:0,z:e},a[21][22]={x:0,y:0,z:1},a[21][33]={x:-e,y:0,z:e},a[21][44]={x:-1,y:0,z:0},a[21][55]={x:-e,y:0,z:-e},a[21][66]={x:0,y:0,z:-1},a[21][77]={x:e,y:0,z:-e},a[21][88]={x:1,y:0,z:0};for(var u=1;u<=10;u++){var l=n[u-1].cos,c=n[u-1].sin;a[21][u]={x:l,y:0,z:c},a[21][22-u]={x:c,y:0,z:l},a[21][22+u]={x:-c,y:0,z:l},a[21][44-u]={x:-l,y:0,z:c},a[21][44+u]={x:-l,y:0,z:-c},a[21][66-u]={x:-c,y:0,z:-l},a[21][66+u]={x:c,y:0,z:-l},a[21][88-u]={x:l,y:0,z:-c}}for(var h=10,f=32,v=0;v<89;v++){var d=a[21][v].x*e,m=a[21][v].z*e;a[h][v]={x:d,y:e,z:m},a[f][v]={x:d,y:-e,z:m}}for(var w=1;w<=10;w++)for(var p=n[w-1].cos,b=n[w-1].sin,g=0;g<89;g++){var y=a[21][g].x*b,M=a[21][g].z*b,x=a[21][g].x*p,P=a[21][g].z*p;a[w-1][g]={x:y,y:p,z:M},a[21-w][g]={x:x,y:b,z:P},a[21+w][g]={x:x,y:-b,z:P},a[43-w][g]={x:y,y:-p,z:M}}for(var S=Array(8*a.length),C=0,A=.011363636363636364,B=.022727272727272728,T=A/2,E=0;E<88;E++)S[C++]=0,S[C++]=1,S[C++]=0,S[C++]=0,S[C++]=1,S[C++]=0,S[C++]=T,S[C++]=1,T+=A;for(var z=1-B,k=0;k<43;k++){for(var R=0,I=0;I<89;I++)S[C++]=a[k][I].x,S[C++]=a[k][I].y,S[C++]=a[k][I].z,S[C++]=a[k][I].x,S[C++]=a[k][I].y,S[C++]=a[k][I].z,S[C++]=R,S[C++]=z,R+=A;z-=B}for(var U=A/2,D=0;D<88;D++)S[C++]=0,S[C++]=-1,S[C++]=0,S[C++]=0,S[C++]=-1,S[C++]=0,S[C++]=U,S[C++]=0,U+=A;for(var F=88,O=Array(3*(2*F+7392)),q=0,L=0;L<F;L++)O[q++]=L,O[q++]=F+L,O[q++]=F+L+1;for(var _=0;_<42;_++)for(var N=0;N<88;N++){var G=F+89*_+N,V=F+89*_+N+1,j=F+89*(_+1)+N,X=F+89*(_+1)+N+1;O[q++]=V,O[q++]=G,O[q++]=X,O[q++]=X,O[q++]=G,O[q++]=j}for(var Y=3827,H=F+Y,K=F+Y-89,Z=0;Z<F;Z++)O[q++]=K+Z,O[q++]=H+Z,O[q++]=K+Z+1;return new t(new Float32Array(S),new Uint16Array(O))}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t,e),t}();o(s,"cube",new s(new Float32Array([1,1,1,0,0,1,1,1,1,-1,1,0,0,1,1,0,-1,-1,1,0,0,1,0,0,-1,1,1,0,0,1,0,1,1,1,-1,0,1,0,1,1,1,1,1,0,1,0,1,0,-1,1,1,0,1,0,0,0,-1,1,-1,0,1,0,0,1,1,-1,1,0,-1,0,1,1,1,-1,-1,0,-1,0,1,0,-1,-1,-1,0,-1,0,0,0,-1,-1,1,0,-1,0,0,1,-1,1,1,-1,0,0,1,1,-1,-1,1,-1,0,0,1,0,-1,-1,-1,-1,0,0,0,0,-1,1,-1,-1,0,0,0,1,1,1,-1,1,0,0,1,1,1,-1,-1,1,0,0,1,0,1,-1,1,1,0,0,0,0,1,1,1,1,0,0,0,1,-1,1,-1,0,0,-1,1,1,-1,-1,-1,0,0,-1,1,0,1,-1,-1,0,0,-1,0,0,1,1,-1,0,0,-1,0,1]),new Uint16Array([0,1,3,1,2,3,4,5,7,5,6,7,8,9,11,9,10,11,12,13,15,13,14,15,16,17,19,17,18,19,20,21,23,21,22,23])));var u={writable:!0,value:null};function l(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,i)}function c(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){l(o,r,i,a,s,"next",e)}function s(e){l(o,r,i,a,s,"throw",e)}a(void 0)})}}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var v=function(){var e;function t(){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t),h(this,"canvas",document.createElement("canvas")),h(this,"context",this.canvas.getContext("2d")),h(this,"image",new Image)}return e=[{key:"loadPng",value:function(e){var t=this;return c(function(){return f(this,function(n){switch(n.label){case 0:return[4,t.fetchImage(e)];case 1:return[4,createImageBitmap(n.sent())];case 2:return[2,n.sent()]}})})()}},{key:"loadSvg",value:function(e,t,n){var r=this;return c(function(){var i;return f(this,function(o){switch(o.label){case 0:return[4,r.fetchImage(e)];case 1:return i=o.sent(),[4,r.svgToPng(i,t,n)];case 2:return[4,createImageBitmap(o.sent())];case 3:return[2,o.sent()]}})})()}},{key:"loadSvgMipmaps",value:function(e,t,n,r){var i=this;return c(function(){var o,a,s;return f(this,function(u){switch(u.label){case 0:return[4,i.fetchImage(e)];case 1:o=u.sent(),a=Array(r),s=0,u.label=2;case 2:if(!(s<r))return[3,6];return[4,i.svgToPng(o,t,n)];case 3:return[4,createImageBitmap(u.sent())];case 4:a[s]=u.sent(),t>>=1,n>>=1,u.label=5;case 5:return s++,[3,2];case 6:return[2,a]}})})()}},{key:"fetchImage",value:function(e){return c(function(){var t;return f(this,function(n){switch(n.label){case 0:return[4,fetch(e)];case 1:if(!(t=n.sent()).ok)throw Error("fetch error '".concat(e,"': ").concat(t.status));return[4,t.blob()];case 2:return[2,n.sent()]}})})()}},{key:"svgToPng",value:function(e,t,n){var r=this;return c(function(){return f(this,function(i){switch(i.label){case 0:return[4,new Promise(function(i,o){r.image.onload=function(){r.canvas.width=t,r.canvas.height=n,r.context.drawImage(r.image,0,0,r.canvas.width,r.canvas.height),URL.revokeObjectURL(r.image.src),r.canvas.toBlob(function(e){return null!==e?i(e):o("'canvas.toBlob(...)' failed: it returned null")})},r.image.src=URL.createObjectURL(e)})];case 1:return[2,i.sent()]}})})()}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}();let d=function(e,t){return class extends e{constructor(...e){super(...e),t(this)}}}(Array,e=>e.fill(0)),m=new Map;function w(e){let t=m.get(e);return t||(t=function(e){function t(n=0,r=0){let i=new e(2);return void 0!==n&&(i[0]=n,void 0!==r&&(i[1]=r)),i}function n(t,n,r){let i=r??new e(2);return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i}function r(t,n,r,i){let o=i??new e(2);return o[0]=t[0]+r*(n[0]-t[0]),o[1]=t[1]+r*(n[1]-t[1]),o}function i(t,n,r){let i=r??new e(2);return i[0]=t[0]*n,i[1]=t[1]*n,i}function o(t,n){let r=n??new e(2);return r[0]=1/t[0],r[1]=1/t[1],r}function a(e,t){return e[0]*t[0]+e[1]*t[1]}function s(e){let t=e[0],n=e[1];return Math.sqrt(t*t+n*n)}function u(e){let t=e[0],n=e[1];return t*t+n*n}function l(e,t){let n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)}function c(e,t){let n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function h(t,n){let r=n??new e(2),i=t[0],o=t[1],a=Math.sqrt(i*i+o*o);return a>1e-5?(r[0]=i/a,r[1]=o/a):(r[0]=0,r[1]=0),r}function f(t,n){let r=n??new e(2);return r[0]=t[0],r[1]=t[1],r}function v(t,n,r){let i=r??new e(2);return i[0]=t[0]*n[0],i[1]=t[1]*n[1],i}function d(t,n,r){let i=r??new e(2);return i[0]=t[0]/n[0],i[1]=t[1]/n[1],i}function m(t,n,r){let o=r??new e(2);return h(t,o),i(o,n,o)}return{create:t,fromValues:t,set:function(t,n,r){let i=r??new e(2);return i[0]=t,i[1]=n,i},ceil:function(t,n){let r=n??new e(2);return r[0]=Math.ceil(t[0]),r[1]=Math.ceil(t[1]),r},floor:function(t,n){let r=n??new e(2);return r[0]=Math.floor(t[0]),r[1]=Math.floor(t[1]),r},round:function(t,n){let r=n??new e(2);return r[0]=Math.round(t[0]),r[1]=Math.round(t[1]),r},clamp:function(t,n=0,r=1,i){let o=i??new e(2);return o[0]=Math.min(r,Math.max(n,t[0])),o[1]=Math.min(r,Math.max(n,t[1])),o},add:function(t,n,r){let i=r??new e(2);return i[0]=t[0]+n[0],i[1]=t[1]+n[1],i},addScaled:function(t,n,r,i){let o=i??new e(2);return o[0]=t[0]+n[0]*r,o[1]=t[1]+n[1]*r,o},angle:function(e,t){let n=e[0],r=e[1],i=t[0],o=t[1],s=Math.sqrt(n*n+r*r)*Math.sqrt(i*i+o*o);return Math.acos(s&&a(e,t)/s)},subtract:n,sub:n,equalsApproximately:function(e,t){return 1e-6>Math.abs(e[0]-t[0])&&1e-6>Math.abs(e[1]-t[1])},equals:function(e,t){return e[0]===t[0]&&e[1]===t[1]},lerp:r,lerpV:function(t,n,r,i){let o=i??new e(2);return o[0]=t[0]+r[0]*(n[0]-t[0]),o[1]=t[1]+r[1]*(n[1]-t[1]),o},max:function(t,n,r){let i=r??new e(2);return i[0]=Math.max(t[0],n[0]),i[1]=Math.max(t[1],n[1]),i},min:function(t,n,r){let i=r??new e(2);return i[0]=Math.min(t[0],n[0]),i[1]=Math.min(t[1],n[1]),i},mulScalar:i,scale:i,divScalar:function(t,n,r){let i=r??new e(2);return i[0]=t[0]/n,i[1]=t[1]/n,i},inverse:o,invert:o,cross:function(t,n,r){let i=r??new e(3),o=t[0]*n[1]-t[1]*n[0];return i[0]=0,i[1]=0,i[2]=o,i},dot:a,length:s,len:s,lengthSq:u,lenSq:u,distance:l,dist:l,distanceSq:c,distSq:c,normalize:h,negate:function(t,n){let r=n??new e(2);return r[0]=-t[0],r[1]=-t[1],r},copy:f,clone:f,multiply:v,mul:v,divide:d,div:d,random:function(t=1,n){let r=n??new e(2),i=2*Math.random()*Math.PI;return r[0]=Math.cos(i)*t,r[1]=Math.sin(i)*t,r},zero:function(t){let n=t??new e(2);return n[0]=0,n[1]=0,n},transformMat4:function(t,n,r){let i=r??new e(2),o=t[0],a=t[1];return i[0]=o*n[0]+a*n[4]+n[12],i[1]=o*n[1]+a*n[5]+n[13],i},transformMat3:function(t,n,r){let i=r??new e(2),o=t[0],a=t[1];return i[0]=n[0]*o+n[4]*a+n[8],i[1]=n[1]*o+n[5]*a+n[9],i},rotate:function(t,n,r,i){let o=i??new e(2),a=t[0]-n[0],s=t[1]-n[1],u=Math.sin(r),l=Math.cos(r);return o[0]=a*l-s*u+n[0],o[1]=a*u+s*l+n[1],o},setLength:m,truncate:function(t,n,r){let i=r??new e(2);return s(t)>n?m(t,n,i):f(t,i)},midpoint:function(t,n,i){return r(t,n,.5,i??new e(2))}}}(e),m.set(e,t)),t}let p=new Map;function b(e){let t=p.get(e);return t||(t=function(e){function t(t,n,r){let i=new e(3);return void 0!==t&&(i[0]=t,void 0!==n&&(i[1]=n,void 0!==r&&(i[2]=r))),i}function n(t,n,r){let i=r??new e(3);return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],i}function r(t,n,r,i){let o=i??new e(3);return o[0]=t[0]+r*(n[0]-t[0]),o[1]=t[1]+r*(n[1]-t[1]),o[2]=t[2]+r*(n[2]-t[2]),o}function i(t,n,r){let i=r??new e(3);return i[0]=t[0]*n,i[1]=t[1]*n,i[2]=t[2]*n,i}function o(t,n){let r=n??new e(3);return r[0]=1/t[0],r[1]=1/t[1],r[2]=1/t[2],r}function a(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function s(e){let t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)}function u(e){let t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}function l(e,t){let n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+r*r+i*i)}function c(e,t){let n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function h(t,n){let r=n??new e(3),i=t[0],o=t[1],a=t[2],s=Math.sqrt(i*i+o*o+a*a);return s>1e-5?(r[0]=i/s,r[1]=o/s,r[2]=a/s):(r[0]=0,r[1]=0,r[2]=0),r}function f(t,n){let r=n??new e(3);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r}function v(t,n,r){let i=r??new e(3);return i[0]=t[0]*n[0],i[1]=t[1]*n[1],i[2]=t[2]*n[2],i}function d(t,n,r){let i=r??new e(3);return i[0]=t[0]/n[0],i[1]=t[1]/n[1],i[2]=t[2]/n[2],i}function m(t,n,r){let o=r??new e(3);return h(t,o),i(o,n,o)}return{create:t,fromValues:t,set:function(t,n,r,i){let o=i??new e(3);return o[0]=t,o[1]=n,o[2]=r,o},ceil:function(t,n){let r=n??new e(3);return r[0]=Math.ceil(t[0]),r[1]=Math.ceil(t[1]),r[2]=Math.ceil(t[2]),r},floor:function(t,n){let r=n??new e(3);return r[0]=Math.floor(t[0]),r[1]=Math.floor(t[1]),r[2]=Math.floor(t[2]),r},round:function(t,n){let r=n??new e(3);return r[0]=Math.round(t[0]),r[1]=Math.round(t[1]),r[2]=Math.round(t[2]),r},clamp:function(t,n=0,r=1,i){let o=i??new e(3);return o[0]=Math.min(r,Math.max(n,t[0])),o[1]=Math.min(r,Math.max(n,t[1])),o[2]=Math.min(r,Math.max(n,t[2])),o},add:function(t,n,r){let i=r??new e(3);return i[0]=t[0]+n[0],i[1]=t[1]+n[1],i[2]=t[2]+n[2],i},addScaled:function(t,n,r,i){let o=i??new e(3);return o[0]=t[0]+n[0]*r,o[1]=t[1]+n[1]*r,o[2]=t[2]+n[2]*r,o},angle:function(e,t){let n=e[0],r=e[1],i=e[2],o=t[0],s=t[1],u=t[2],l=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(o*o+s*s+u*u);return Math.acos(l&&a(e,t)/l)},subtract:n,sub:n,equalsApproximately:function(e,t){return 1e-6>Math.abs(e[0]-t[0])&&1e-6>Math.abs(e[1]-t[1])&&1e-6>Math.abs(e[2]-t[2])},equals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},lerp:r,lerpV:function(t,n,r,i){let o=i??new e(3);return o[0]=t[0]+r[0]*(n[0]-t[0]),o[1]=t[1]+r[1]*(n[1]-t[1]),o[2]=t[2]+r[2]*(n[2]-t[2]),o},max:function(t,n,r){let i=r??new e(3);return i[0]=Math.max(t[0],n[0]),i[1]=Math.max(t[1],n[1]),i[2]=Math.max(t[2],n[2]),i},min:function(t,n,r){let i=r??new e(3);return i[0]=Math.min(t[0],n[0]),i[1]=Math.min(t[1],n[1]),i[2]=Math.min(t[2],n[2]),i},mulScalar:i,scale:i,divScalar:function(t,n,r){let i=r??new e(3);return i[0]=t[0]/n,i[1]=t[1]/n,i[2]=t[2]/n,i},inverse:o,invert:o,cross:function(t,n,r){let i=r??new e(3),o=t[2]*n[0]-t[0]*n[2],a=t[0]*n[1]-t[1]*n[0];return i[0]=t[1]*n[2]-t[2]*n[1],i[1]=o,i[2]=a,i},dot:a,length:s,len:s,lengthSq:u,lenSq:u,distance:l,dist:l,distanceSq:c,distSq:c,normalize:h,negate:function(t,n){let r=n??new e(3);return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r},copy:f,clone:f,multiply:v,mul:v,divide:d,div:d,random:function(t=1,n){let r=n??new e(3),i=2*Math.random()*Math.PI,o=2*Math.random()-1,a=Math.sqrt(1-o*o)*t;return r[0]=Math.cos(i)*a,r[1]=Math.sin(i)*a,r[2]=o*t,r},zero:function(t){let n=t??new e(3);return n[0]=0,n[1]=0,n[2]=0,n},transformMat4:function(t,n,r){let i=r??new e(3),o=t[0],a=t[1],s=t[2],u=n[3]*o+n[7]*a+n[11]*s+n[15]||1;return i[0]=(n[0]*o+n[4]*a+n[8]*s+n[12])/u,i[1]=(n[1]*o+n[5]*a+n[9]*s+n[13])/u,i[2]=(n[2]*o+n[6]*a+n[10]*s+n[14])/u,i},transformMat4Upper3x3:function(t,n,r){let i=r??new e(3),o=t[0],a=t[1],s=t[2];return i[0]=o*n[0]+a*n[4]+s*n[8],i[1]=o*n[1]+a*n[5]+s*n[9],i[2]=o*n[2]+a*n[6]+s*n[10],i},transformMat3:function(t,n,r){let i=r??new e(3),o=t[0],a=t[1],s=t[2];return i[0]=o*n[0]+a*n[4]+s*n[8],i[1]=o*n[1]+a*n[5]+s*n[9],i[2]=o*n[2]+a*n[6]+s*n[10],i},transformQuat:function(t,n,r){let i=r??new e(3),o=n[0],a=n[1],s=n[2],u=2*n[3],l=t[0],c=t[1],h=t[2],f=a*h-s*c,v=s*l-o*h,d=o*c-a*l;return i[0]=l+f*u+(a*d-s*v)*2,i[1]=c+v*u+(s*f-o*d)*2,i[2]=h+d*u+(o*v-a*f)*2,i},getTranslation:function(t,n){let r=n??new e(3);return r[0]=t[12],r[1]=t[13],r[2]=t[14],r},getAxis:function(t,n,r){let i=r??new e(3),o=4*n;return i[0]=t[o+0],i[1]=t[o+1],i[2]=t[o+2],i},getScaling:function(t,n){let r=n??new e(3),i=t[0],o=t[1],a=t[2],s=t[4],u=t[5],l=t[6],c=t[8],h=t[9],f=t[10];return r[0]=Math.sqrt(i*i+o*o+a*a),r[1]=Math.sqrt(s*s+u*u+l*l),r[2]=Math.sqrt(c*c+h*h+f*f),r},rotateX:function(t,n,r,i){let o=i??new e(3),a=[],s=[];return a[0]=t[0]-n[0],a[1]=t[1]-n[1],a[2]=t[2]-n[2],s[0]=a[0],s[1]=a[1]*Math.cos(r)-a[2]*Math.sin(r),s[2]=a[1]*Math.sin(r)+a[2]*Math.cos(r),o[0]=s[0]+n[0],o[1]=s[1]+n[1],o[2]=s[2]+n[2],o},rotateY:function(t,n,r,i){let o=i??new e(3),a=[],s=[];return a[0]=t[0]-n[0],a[1]=t[1]-n[1],a[2]=t[2]-n[2],s[0]=a[2]*Math.sin(r)+a[0]*Math.cos(r),s[1]=a[1],s[2]=a[2]*Math.cos(r)-a[0]*Math.sin(r),o[0]=s[0]+n[0],o[1]=s[1]+n[1],o[2]=s[2]+n[2],o},rotateZ:function(t,n,r,i){let o=i??new e(3),a=[],s=[];return a[0]=t[0]-n[0],a[1]=t[1]-n[1],a[2]=t[2]-n[2],s[0]=a[0]*Math.cos(r)-a[1]*Math.sin(r),s[1]=a[0]*Math.sin(r)+a[1]*Math.cos(r),s[2]=a[2],o[0]=s[0]+n[0],o[1]=s[1]+n[1],o[2]=s[2]+n[2],o},setLength:m,truncate:function(t,n,r){let i=r??new e(3);return s(t)>n?m(t,n,i):f(t,i)},midpoint:function(t,n,i){return r(t,n,.5,i??new e(3))}}}(e),p.set(e,t)),t}let g=new Map,y=new Map,M=new Map,x=new Map;function P(e,t,n,r,i,o){let a,s,u,l;return{mat3:((a=g.get(e))||(a=function(e){let t=w(e),n=b(e);function r(t,n,r){let i=r??new e(12);return i[0]=t[0]*n,i[1]=t[1]*n,i[2]=t[2]*n,i[4]=t[4]*n,i[5]=t[5]*n,i[6]=t[6]*n,i[8]=t[8]*n,i[9]=t[9]*n,i[10]=t[10]*n,i}function i(t,n){let r=n??new e(12);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[8]=t[8],r[9]=t[9],r[10]=t[10],r}function o(t){let n=t??new e(12);return n[0]=1,n[1]=0,n[2]=0,n[4]=0,n[5]=1,n[6]=0,n[8]=0,n[9]=0,n[10]=1,n}function a(t,n){let r=n??new e(12),i=t[0],o=t[1],a=t[2],s=t[4],u=t[5],l=t[6],c=t[8],h=t[9],f=t[10],v=f*u-l*h,d=-f*s+l*c,m=h*s-u*c,w=1/(i*v+o*d+a*m);return r[0]=v*w,r[1]=(-f*o+a*h)*w,r[2]=(l*o-a*u)*w,r[4]=d*w,r[5]=(f*i-a*c)*w,r[6]=(-l*i+a*s)*w,r[8]=m*w,r[9]=(-h*i+o*c)*w,r[10]=(u*i-o*s)*w,r}function s(t,n,r){let i=r??new e(12),o=t[0],a=t[1],s=t[2],u=t[4],l=t[5],c=t[6],h=t[8],f=t[9],v=t[10],d=n[0],m=n[1],w=n[2],p=n[4],b=n[5],g=n[6],y=n[8],M=n[9],x=n[10];return i[0]=o*d+u*m+h*w,i[1]=a*d+l*m+f*w,i[2]=s*d+c*m+v*w,i[4]=o*p+u*b+h*g,i[5]=a*p+l*b+f*g,i[6]=s*p+c*b+v*g,i[8]=o*y+u*M+h*x,i[9]=a*y+l*M+f*x,i[10]=s*y+c*M+v*x,i}function u(t,n){let r=n??new e(12),i=Math.cos(t),o=Math.sin(t);return r[0]=i,r[1]=o,r[2]=0,r[4]=-o,r[5]=i,r[6]=0,r[8]=0,r[9]=0,r[10]=1,r}function l(t,n,r){let i=r??new e(12),o=t[0],a=t[1],s=t[2],u=t[4],l=t[5],c=t[6],h=Math.cos(n),f=Math.sin(n);return i[0]=h*o+f*u,i[1]=h*a+f*l,i[2]=h*s+f*c,i[4]=h*u-f*o,i[5]=h*l-f*a,i[6]=h*c-f*s,t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10]),i}return{add:function(t,n,r){let i=r??new e(12);return i[0]=t[0]+n[0],i[1]=t[1]+n[1],i[2]=t[2]+n[2],i[4]=t[4]+n[4],i[5]=t[5]+n[5],i[6]=t[6]+n[6],i[8]=t[8]+n[8],i[9]=t[9]+n[9],i[10]=t[10]+n[10],i},clone:i,copy:i,create:function(t,n,r,i,o,a,s,u,l){let c=new e(12);return c[3]=0,c[7]=0,c[11]=0,void 0!==t&&(c[0]=t,void 0!==n&&(c[1]=n,void 0!==r&&(c[2]=r,void 0!==i&&(c[4]=i,void 0!==o&&(c[5]=o,void 0!==a&&(c[6]=a,void 0!==s&&(c[8]=s,void 0!==u&&(c[9]=u,void 0!==l&&(c[10]=l))))))))),c},determinant:function(e){let t=e[0],n=e[1],r=e[2],i=e[4],o=e[5],a=e[6],s=e[8],u=e[9],l=e[10];return t*(o*l-u*a)-i*(n*l-u*r)+s*(n*a-o*r)},equals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]},equalsApproximately:function(e,t){return 1e-6>Math.abs(e[0]-t[0])&&1e-6>Math.abs(e[1]-t[1])&&1e-6>Math.abs(e[2]-t[2])&&1e-6>Math.abs(e[4]-t[4])&&1e-6>Math.abs(e[5]-t[5])&&1e-6>Math.abs(e[6]-t[6])&&1e-6>Math.abs(e[8]-t[8])&&1e-6>Math.abs(e[9]-t[9])&&1e-6>Math.abs(e[10]-t[10])},fromMat4:function(t,n){let r=n??new e(12);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=0,r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=0,r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=0,r},fromQuat:function(t,n){let r=n??new e(12),i=t[0],o=t[1],a=t[2],s=t[3],u=i+i,l=o+o,c=a+a,h=i*u,f=o*u,v=o*l,d=a*u,m=a*l,w=a*c,p=s*u,b=s*l,g=s*c;return r[0]=1-v-w,r[1]=f+g,r[2]=d-b,r[3]=0,r[4]=f-g,r[5]=1-h-w,r[6]=m+p,r[7]=0,r[8]=d+b,r[9]=m-p,r[10]=1-h-v,r[11]=0,r},get3DScaling:function(e,t){let r=t??n.create(),i=e[0],o=e[1],a=e[2],s=e[4],u=e[5],l=e[6],c=e[8],h=e[9],f=e[10];return r[0]=Math.sqrt(i*i+o*o+a*a),r[1]=Math.sqrt(s*s+u*u+l*l),r[2]=Math.sqrt(c*c+h*h+f*f),r},getAxis:function(e,n,r){let i=r??t.create(),o=4*n;return i[0]=e[o+0],i[1]=e[o+1],i},getScaling:function(e,n){let r=n??t.create(),i=e[0],o=e[1],a=e[4],s=e[5];return r[0]=Math.sqrt(i*i+o*o),r[1]=Math.sqrt(a*a+s*s),r},getTranslation:function(e,n){let r=n??t.create();return r[0]=e[8],r[1]=e[9],r},identity:o,inverse:a,invert:a,mul:s,mulScalar:r,multiply:s,multiplyScalar:r,negate:function(t,n){let r=n??new e(12);return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r[4]=-t[4],r[5]=-t[5],r[6]=-t[6],r[8]=-t[8],r[9]=-t[9],r[10]=-t[10],r},rotate:l,rotateX:function(t,n,r){let i=r??new e(12),o=t[4],a=t[5],s=t[6],u=t[8],l=t[9],c=t[10],h=Math.cos(n),f=Math.sin(n);return i[4]=h*o+f*u,i[5]=h*a+f*l,i[6]=h*s+f*c,i[8]=h*u-f*o,i[9]=h*l-f*a,i[10]=h*c-f*s,t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2]),i},rotateY:function(t,n,r){let i=r??new e(12),o=t[0],a=t[1],s=t[2],u=t[8],l=t[9],c=t[10],h=Math.cos(n),f=Math.sin(n);return i[0]=h*o-f*u,i[1]=h*a-f*l,i[2]=h*s-f*c,i[8]=h*u+f*o,i[9]=h*l+f*a,i[10]=h*c+f*s,t!==i&&(i[4]=t[4],i[5]=t[5],i[6]=t[6]),i},rotateZ:l,rotation:u,rotationX:function(t,n){let r=n??new e(12),i=Math.cos(t),o=Math.sin(t);return r[0]=1,r[1]=0,r[2]=0,r[4]=0,r[5]=i,r[6]=o,r[8]=0,r[9]=-o,r[10]=i,r},rotationY:function(t,n){let r=n??new e(12),i=Math.cos(t),o=Math.sin(t);return r[0]=i,r[1]=0,r[2]=-o,r[4]=0,r[5]=1,r[6]=0,r[8]=o,r[9]=0,r[10]=i,r},rotationZ:u,scale:function(t,n,r){let i=r??new e(12),o=n[0],a=n[1];return i[0]=o*t[0],i[1]=o*t[1],i[2]=o*t[2],i[4]=a*t[4],i[5]=a*t[5],i[6]=a*t[6],t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10]),i},scale3D:function(t,n,r){let i=r??new e(12),o=n[0],a=n[1],s=n[2];return i[0]=o*t[0],i[1]=o*t[1],i[2]=o*t[2],i[4]=a*t[4],i[5]=a*t[5],i[6]=a*t[6],i[8]=s*t[8],i[9]=s*t[9],i[10]=s*t[10],i},scaling:function(t,n){let r=n??new e(12);return r[0]=t[0],r[1]=0,r[2]=0,r[4]=0,r[5]=t[1],r[6]=0,r[8]=0,r[9]=0,r[10]=1,r},scaling3D:function(t,n){let r=n??new e(12);return r[0]=t[0],r[1]=0,r[2]=0,r[4]=0,r[5]=t[1],r[6]=0,r[8]=0,r[9]=0,r[10]=t[2],r},set:function(t,n,r,i,o,a,s,u,l,c){let h=c??new e(12);return h[0]=t,h[1]=n,h[2]=r,h[3]=0,h[4]=i,h[5]=o,h[6]=a,h[7]=0,h[8]=s,h[9]=u,h[10]=l,h[11]=0,h},setAxis:function(e,t,n,r){let o=r===e?e:i(e,r),a=4*n;return o[a+0]=t[0],o[a+1]=t[1],o},setTranslation:function(e,t,n){let r=n??o();return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[4]=e[4],r[5]=e[5],r[6]=e[6]),r[8]=t[0],r[9]=t[1],r[10]=1,r},translate:function(t,n,r){let i=r??new e(12),o=n[0],a=n[1],s=t[0],u=t[1],l=t[2],c=t[4],h=t[5],f=t[6],v=t[8],d=t[9],m=t[10];return t!==i&&(i[0]=s,i[1]=u,i[2]=l,i[4]=c,i[5]=h,i[6]=f),i[8]=s*o+c*a+v,i[9]=u*o+h*a+d,i[10]=l*o+f*a+m,i},translation:function(t,n){let r=n??new e(12);return r[0]=1,r[1]=0,r[2]=0,r[4]=0,r[5]=1,r[6]=0,r[8]=t[0],r[9]=t[1],r[10]=1,r},transpose:function(t,n){let r=n??new e(12);if(r===t){let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,r}let i=t[0],o=t[1],a=t[2],s=t[4],u=t[5],l=t[6],c=t[8],h=t[9],f=t[10];return r[0]=i,r[1]=s,r[2]=c,r[4]=o,r[5]=u,r[6]=h,r[8]=a,r[9]=l,r[10]=f,r},uniformScale:function(t,n,r){let i=r??new e(12);return i[0]=n*t[0],i[1]=n*t[1],i[2]=n*t[2],i[4]=n*t[4],i[5]=n*t[5],i[6]=n*t[6],t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10]),i},uniformScale3D:function(t,n,r){let i=r??new e(12);return i[0]=n*t[0],i[1]=n*t[1],i[2]=n*t[2],i[4]=n*t[4],i[5]=n*t[5],i[6]=n*t[6],i[8]=n*t[8],i[9]=n*t[9],i[10]=n*t[10],i},uniformScaling:function(t,n){let r=n??new e(12);return r[0]=t,r[1]=0,r[2]=0,r[4]=0,r[5]=t,r[6]=0,r[8]=0,r[9]=0,r[10]=1,r},uniformScaling3D:function(t,n){let r=n??new e(12);return r[0]=t,r[1]=0,r[2]=0,r[4]=0,r[5]=t,r[6]=0,r[8]=0,r[9]=0,r[10]=t,r}}}(e),g.set(e,a)),a),mat4:((s=y.get(t))||(s=function(e){let t=b(e);function n(t,n,r){let i=r??new e(16);return i[0]=t[0]*n,i[1]=t[1]*n,i[2]=t[2]*n,i[3]=t[3]*n,i[4]=t[4]*n,i[5]=t[5]*n,i[6]=t[6]*n,i[7]=t[7]*n,i[8]=t[8]*n,i[9]=t[9]*n,i[10]=t[10]*n,i[11]=t[11]*n,i[12]=t[12]*n,i[13]=t[13]*n,i[14]=t[14]*n,i[15]=t[15]*n,i}function r(t,n){let r=n??new e(16);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r}function i(t){let n=t??new e(16);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function o(t,n){let r=n??new e(16),i=t[0],o=t[1],a=t[2],s=t[3],u=t[4],l=t[5],c=t[6],h=t[7],f=t[8],v=t[9],d=t[10],m=t[11],w=t[12],p=t[13],b=t[14],g=t[15],y=d*g,M=b*m,x=c*g,P=b*h,S=c*m,C=d*h,A=a*g,B=b*s,T=a*m,E=d*s,z=a*h,k=c*s,R=f*p,I=w*v,U=u*p,D=w*l,F=u*v,O=f*l,q=i*p,L=w*o,_=i*v,N=f*o,G=i*l,V=u*o,j=y*l+P*v+S*p-(M*l+x*v+C*p),X=M*o+A*v+E*p-(y*o+B*v+T*p),Y=x*o+B*l+z*p-(P*o+A*l+k*p),H=C*o+T*l+k*v-(S*o+E*l+z*v),K=1/(i*j+u*X+f*Y+w*H);return r[0]=K*j,r[1]=K*X,r[2]=K*Y,r[3]=K*H,r[4]=K*(M*u+x*f+C*w-(y*u+P*f+S*w)),r[5]=K*(y*i+B*f+T*w-(M*i+A*f+E*w)),r[6]=K*(P*i+A*u+k*w-(x*i+B*u+z*w)),r[7]=K*(S*i+E*u+z*f-(C*i+T*u+k*f)),r[8]=K*(R*h+D*m+F*g-(I*h+U*m+O*g)),r[9]=K*(I*s+q*m+N*g-(R*s+L*m+_*g)),r[10]=K*(U*s+L*h+G*g-(D*s+q*h+V*g)),r[11]=K*(O*s+_*h+V*m-(F*s+N*h+G*m)),r[12]=K*(U*d+O*b+I*c-(F*b+R*c+D*d)),r[13]=K*(_*b+R*a+L*d-(q*d+N*b+I*a)),r[14]=K*(q*c+V*b+D*a-(G*b+U*a+L*c)),r[15]=K*(G*d+F*a+N*c-(_*c+V*d+O*a)),r}function a(t,n,r){let i=r??new e(16),o=t[0],a=t[1],s=t[2],u=t[3],l=t[4],c=t[5],h=t[6],f=t[7],v=t[8],d=t[9],m=t[10],w=t[11],p=t[12],b=t[13],g=t[14],y=t[15],M=n[0],x=n[1],P=n[2],S=n[3],C=n[4],A=n[5],B=n[6],T=n[7],E=n[8],z=n[9],k=n[10],R=n[11],I=n[12],U=n[13],D=n[14],F=n[15];return i[0]=o*M+l*x+v*P+p*S,i[1]=a*M+c*x+d*P+b*S,i[2]=s*M+h*x+m*P+g*S,i[3]=u*M+f*x+w*P+y*S,i[4]=o*C+l*A+v*B+p*T,i[5]=a*C+c*A+d*B+b*T,i[6]=s*C+h*A+m*B+g*T,i[7]=u*C+f*A+w*B+y*T,i[8]=o*E+l*z+v*k+p*R,i[9]=a*E+c*z+d*k+b*R,i[10]=s*E+h*z+m*k+g*R,i[11]=u*E+f*z+w*k+y*R,i[12]=o*I+l*U+v*D+p*F,i[13]=a*I+c*U+d*D+b*F,i[14]=s*I+h*U+m*D+g*F,i[15]=u*I+f*U+w*D+y*F,i}let s=t.create(),u=t.create(),l=t.create();function c(t,n,r){let i=r??new e(16),o=t[0],a=t[1],s=t[2],u=Math.sqrt(o*o+a*a+s*s),l=(o/=u)*o,c=(a/=u)*a,h=(s/=u)*s,f=Math.cos(n),v=Math.sin(n),d=1-f;return i[0]=l+(1-l)*f,i[1]=o*a*d+s*v,i[2]=o*s*d-a*v,i[3]=0,i[4]=o*a*d-s*v,i[5]=c+(1-c)*f,i[6]=a*s*d+o*v,i[7]=0,i[8]=o*s*d+a*v,i[9]=a*s*d-o*v,i[10]=h+(1-h)*f,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function h(t,n,r,i){let o=i??new e(16),a=n[0],s=n[1],u=n[2],l=Math.sqrt(a*a+s*s+u*u),c=(a/=l)*a,h=(s/=l)*s,f=(u/=l)*u,v=Math.cos(r),d=Math.sin(r),m=1-v,w=c+(1-c)*v,p=a*s*m+u*d,b=a*u*m-s*d,g=a*s*m-u*d,y=h+(1-h)*v,M=s*u*m+a*d,x=a*u*m+s*d,P=s*u*m-a*d,S=f+(1-f)*v,C=t[0],A=t[1],B=t[2],T=t[3],E=t[4],z=t[5],k=t[6],R=t[7],I=t[8],U=t[9],D=t[10],F=t[11];return o[0]=w*C+p*E+b*I,o[1]=w*A+p*z+b*U,o[2]=w*B+p*k+b*D,o[3]=w*T+p*R+b*F,o[4]=g*C+y*E+M*I,o[5]=g*A+y*z+M*U,o[6]=g*B+y*k+M*D,o[7]=g*T+y*R+M*F,o[8]=x*C+P*E+S*I,o[9]=x*A+P*z+S*U,o[10]=x*B+P*k+S*D,o[11]=x*T+P*R+S*F,t!==o&&(o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15]),o}return{add:function(t,n,r){let i=r??new e(16);return i[0]=t[0]+n[0],i[1]=t[1]+n[1],i[2]=t[2]+n[2],i[3]=t[3]+n[3],i[4]=t[4]+n[4],i[5]=t[5]+n[5],i[6]=t[6]+n[6],i[7]=t[7]+n[7],i[8]=t[8]+n[8],i[9]=t[9]+n[9],i[10]=t[10]+n[10],i[11]=t[11]+n[11],i[12]=t[12]+n[12],i[13]=t[13]+n[13],i[14]=t[14]+n[14],i[15]=t[15]+n[15],i},aim:function(n,r,i,o){let a=o??new e(16);return t.normalize(t.subtract(r,n,l),l),t.normalize(t.cross(i,l,s),s),t.normalize(t.cross(l,s,u),u),a[0]=s[0],a[1]=s[1],a[2]=s[2],a[3]=0,a[4]=u[0],a[5]=u[1],a[6]=u[2],a[7]=0,a[8]=l[0],a[9]=l[1],a[10]=l[2],a[11]=0,a[12]=n[0],a[13]=n[1],a[14]=n[2],a[15]=1,a},axisRotate:h,axisRotation:c,cameraAim:function(n,r,i,o){let a=o??new e(16);return t.normalize(t.subtract(n,r,l),l),t.normalize(t.cross(i,l,s),s),t.normalize(t.cross(l,s,u),u),a[0]=s[0],a[1]=s[1],a[2]=s[2],a[3]=0,a[4]=u[0],a[5]=u[1],a[6]=u[2],a[7]=0,a[8]=l[0],a[9]=l[1],a[10]=l[2],a[11]=0,a[12]=n[0],a[13]=n[1],a[14]=n[2],a[15]=1,a},clone:r,copy:r,create:function(t,n,r,i,o,a,s,u,l,c,h,f,v,d,m,w){let p=new e(16);return void 0!==t&&(p[0]=t,void 0!==n&&(p[1]=n,void 0!==r&&(p[2]=r,void 0!==i&&(p[3]=i,void 0!==o&&(p[4]=o,void 0!==a&&(p[5]=a,void 0!==s&&(p[6]=s,void 0!==u&&(p[7]=u,void 0!==l&&(p[8]=l,void 0!==c&&(p[9]=c,void 0!==h&&(p[10]=h,void 0!==f&&(p[11]=f,void 0!==v&&(p[12]=v,void 0!==d&&(p[13]=d,void 0!==m&&(p[14]=m,void 0!==w&&(p[15]=w)))))))))))))))),p},determinant:function(e){let t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],l=e[8],c=e[9],h=e[10],f=e[11],v=e[12],d=e[13],m=e[14],w=e[15],p=h*w,b=m*f,g=s*w,y=m*u,M=s*f,x=h*u,P=r*w,S=m*i,C=r*f,A=h*i,B=r*u,T=s*i;return t*(p*a+y*c+M*d-(b*a+g*c+x*d))+o*(b*n+P*c+A*d-(p*n+S*c+C*d))+l*(g*n+S*a+B*d-(y*n+P*a+T*d))+v*(x*n+C*a+T*c-(M*n+A*a+B*c))},equals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},equalsApproximately:function(e,t){return 1e-6>Math.abs(e[0]-t[0])&&1e-6>Math.abs(e[1]-t[1])&&1e-6>Math.abs(e[2]-t[2])&&1e-6>Math.abs(e[3]-t[3])&&1e-6>Math.abs(e[4]-t[4])&&1e-6>Math.abs(e[5]-t[5])&&1e-6>Math.abs(e[6]-t[6])&&1e-6>Math.abs(e[7]-t[7])&&1e-6>Math.abs(e[8]-t[8])&&1e-6>Math.abs(e[9]-t[9])&&1e-6>Math.abs(e[10]-t[10])&&1e-6>Math.abs(e[11]-t[11])&&1e-6>Math.abs(e[12]-t[12])&&1e-6>Math.abs(e[13]-t[13])&&1e-6>Math.abs(e[14]-t[14])&&1e-6>Math.abs(e[15]-t[15])},fromMat3:function(t,n){let r=n??new e(16);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=0,r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=0,r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},fromQuat:function(t,n){let r=n??new e(16),i=t[0],o=t[1],a=t[2],s=t[3],u=i+i,l=o+o,c=a+a,h=i*u,f=o*u,v=o*l,d=a*u,m=a*l,w=a*c,p=s*u,b=s*l,g=s*c;return r[0]=1-v-w,r[1]=f+g,r[2]=d-b,r[3]=0,r[4]=f-g,r[5]=1-h-w,r[6]=m+p,r[7]=0,r[8]=d+b,r[9]=m-p,r[10]=1-h-v,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},frustum:function(t,n,r,i,o,a,s){let u=s??new e(16),l=n-t,c=i-r,h=o-a;return u[0]=2*o/l,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=2*o/c,u[6]=0,u[7]=0,u[8]=(t+n)/l,u[9]=(i+r)/c,u[10]=a/h,u[11]=-1,u[12]=0,u[13]=0,u[14]=o*a/h,u[15]=0,u},frustumReverseZ:function(t,n,r,i,o,a=1/0,s){let u=s??new e(16),l=n-t,c=i-r;if(u[0]=2*o/l,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=2*o/c,u[6]=0,u[7]=0,u[8]=(t+n)/l,u[9]=(i+r)/c,u[11]=-1,u[12]=0,u[13]=0,u[15]=0,a===1/0)u[10]=0,u[14]=o;else{let e=1/(a-o);u[10]=o*e,u[14]=a*o*e}return u},getAxis:function(e,n,r){let i=r??t.create(),o=4*n;return i[0]=e[o+0],i[1]=e[o+1],i[2]=e[o+2],i},getScaling:function(e,n){let r=n??t.create(),i=e[0],o=e[1],a=e[2],s=e[4],u=e[5],l=e[6],c=e[8],h=e[9],f=e[10];return r[0]=Math.sqrt(i*i+o*o+a*a),r[1]=Math.sqrt(s*s+u*u+l*l),r[2]=Math.sqrt(c*c+h*h+f*f),r},getTranslation:function(e,n){let r=n??t.create();return r[0]=e[12],r[1]=e[13],r[2]=e[14],r},identity:i,inverse:o,invert:o,lookAt:function(n,r,i,o){let a=o??new e(16);return t.normalize(t.subtract(n,r,l),l),t.normalize(t.cross(i,l,s),s),t.normalize(t.cross(l,s,u),u),a[0]=s[0],a[1]=u[0],a[2]=l[0],a[3]=0,a[4]=s[1],a[5]=u[1],a[6]=l[1],a[7]=0,a[8]=s[2],a[9]=u[2],a[10]=l[2],a[11]=0,a[12]=-(s[0]*n[0]+s[1]*n[1]+s[2]*n[2]),a[13]=-(u[0]*n[0]+u[1]*n[1]+u[2]*n[2]),a[14]=-(l[0]*n[0]+l[1]*n[1]+l[2]*n[2]),a[15]=1,a},mul:a,mulScalar:n,multiply:a,multiplyScalar:n,negate:function(t,n){let r=n??new e(16);return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r[3]=-t[3],r[4]=-t[4],r[5]=-t[5],r[6]=-t[6],r[7]=-t[7],r[8]=-t[8],r[9]=-t[9],r[10]=-t[10],r[11]=-t[11],r[12]=-t[12],r[13]=-t[13],r[14]=-t[14],r[15]=-t[15],r},ortho:function(t,n,r,i,o,a,s){let u=s??new e(16);return u[0]=2/(n-t),u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=2/(i-r),u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1/(o-a),u[11]=0,u[12]=(n+t)/(t-n),u[13]=(i+r)/(r-i),u[14]=o/(o-a),u[15]=1,u},perspective:function(t,n,r,i,o){let a=o??new e(16),s=Math.tan(.5*Math.PI-.5*t);if(a[0]=s/n,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=s,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,Number.isFinite(i)){let e=1/(r-i);a[10]=i*e,a[14]=i*r*e}else a[10]=-1,a[14]=-r;return a},perspectiveReverseZ:function(t,n,r,i=1/0,o){let a=o??new e(16),s=1/Math.tan(.5*t);if(a[0]=s/n,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=s,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,i===1/0)a[10]=0,a[14]=r;else{let e=1/(i-r);a[10]=r*e,a[14]=i*r*e}return a},rotate:h,rotateX:function(t,n,r){let i=r??new e(16),o=t[4],a=t[5],s=t[6],u=t[7],l=t[8],c=t[9],h=t[10],f=t[11],v=Math.cos(n),d=Math.sin(n);return i[4]=v*o+d*l,i[5]=v*a+d*c,i[6]=v*s+d*h,i[7]=v*u+d*f,i[8]=v*l-d*o,i[9]=v*c-d*a,i[10]=v*h-d*s,i[11]=v*f-d*u,t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i},rotateY:function(t,n,r){let i=r??new e(16),o=t[0],a=t[1],s=t[2],u=t[3],l=t[8],c=t[9],h=t[10],f=t[11],v=Math.cos(n),d=Math.sin(n);return i[0]=v*o-d*l,i[1]=v*a-d*c,i[2]=v*s-d*h,i[3]=v*u-d*f,i[8]=v*l+d*o,i[9]=v*c+d*a,i[10]=v*h+d*s,i[11]=v*f+d*u,t!==i&&(i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i},rotateZ:function(t,n,r){let i=r??new e(16),o=t[0],a=t[1],s=t[2],u=t[3],l=t[4],c=t[5],h=t[6],f=t[7],v=Math.cos(n),d=Math.sin(n);return i[0]=v*o+d*l,i[1]=v*a+d*c,i[2]=v*s+d*h,i[3]=v*u+d*f,i[4]=v*l-d*o,i[5]=v*c-d*a,i[6]=v*h-d*s,i[7]=v*f-d*u,t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i},rotation:c,rotationX:function(t,n){let r=n??new e(16),i=Math.cos(t),o=Math.sin(t);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=i,r[6]=o,r[7]=0,r[8]=0,r[9]=-o,r[10]=i,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},rotationY:function(t,n){let r=n??new e(16),i=Math.cos(t),o=Math.sin(t);return r[0]=i,r[1]=0,r[2]=-o,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=o,r[9]=0,r[10]=i,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},rotationZ:function(t,n){let r=n??new e(16),i=Math.cos(t),o=Math.sin(t);return r[0]=i,r[1]=o,r[2]=0,r[3]=0,r[4]=-o,r[5]=i,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},scale:function(t,n,r){let i=r??new e(16),o=n[0],a=n[1],s=n[2];return i[0]=o*t[0],i[1]=o*t[1],i[2]=o*t[2],i[3]=o*t[3],i[4]=a*t[4],i[5]=a*t[5],i[6]=a*t[6],i[7]=a*t[7],i[8]=s*t[8],i[9]=s*t[9],i[10]=s*t[10],i[11]=s*t[11],t!==i&&(i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i},scaling:function(t,n){let r=n??new e(16);return r[0]=t[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=t[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},set:function(t,n,r,i,o,a,s,u,l,c,h,f,v,d,m,w,p){let b=p??new e(16);return b[0]=t,b[1]=n,b[2]=r,b[3]=i,b[4]=o,b[5]=a,b[6]=s,b[7]=u,b[8]=l,b[9]=c,b[10]=h,b[11]=f,b[12]=v,b[13]=d,b[14]=m,b[15]=w,b},setAxis:function(e,t,n,i){let o=i===e?i:r(e,i),a=4*n;return o[a+0]=t[0],o[a+1]=t[1],o[a+2]=t[2],o},setTranslation:function(e,t,n){let r=n??i();return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11]),r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r},translate:function(t,n,r){let i=r??new e(16),o=n[0],a=n[1],s=n[2],u=t[0],l=t[1],c=t[2],h=t[3],f=t[4],v=t[5],d=t[6],m=t[7],w=t[8],p=t[9],b=t[10],g=t[11],y=t[12],M=t[13],x=t[14],P=t[15];return t!==i&&(i[0]=u,i[1]=l,i[2]=c,i[3]=h,i[4]=f,i[5]=v,i[6]=d,i[7]=m,i[8]=w,i[9]=p,i[10]=b,i[11]=g),i[12]=u*o+f*a+w*s+y,i[13]=l*o+v*a+p*s+M,i[14]=c*o+d*a+b*s+x,i[15]=h*o+m*a+g*s+P,i},translation:function(t,n){let r=n??new e(16);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r},transpose:function(t,n){let r=n??new e(16);if(r===t){let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,r}let i=t[0],o=t[1],a=t[2],s=t[3],u=t[4],l=t[5],c=t[6],h=t[7],f=t[8],v=t[9],d=t[10],m=t[11],w=t[12],p=t[13],b=t[14],g=t[15];return r[0]=i,r[1]=u,r[2]=f,r[3]=w,r[4]=o,r[5]=l,r[6]=v,r[7]=p,r[8]=a,r[9]=c,r[10]=d,r[11]=b,r[12]=s,r[13]=h,r[14]=m,r[15]=g,r},uniformScale:function(t,n,r){let i=r??new e(16);return i[0]=n*t[0],i[1]=n*t[1],i[2]=n*t[2],i[3]=n*t[3],i[4]=n*t[4],i[5]=n*t[5],i[6]=n*t[6],i[7]=n*t[7],i[8]=n*t[8],i[9]=n*t[9],i[10]=n*t[10],i[11]=n*t[11],t!==i&&(i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i},uniformScaling:function(t,n){let r=n??new e(16);return r[0]=t,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=t,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}}}(t),y.set(t,s)),s),quat:((u=M.get(n))||(u=function(e){let t=b(e);function n(t,n,r,i){let o=new e(4);return void 0!==t&&(o[0]=t,void 0!==n&&(o[1]=n,void 0!==r&&(o[2]=r,void 0!==i&&(o[3]=i)))),o}function r(t,n,r){let i=r??new e(4),o=.5*n,a=Math.sin(o);return i[0]=a*t[0],i[1]=a*t[1],i[2]=a*t[2],i[3]=Math.cos(o),i}function i(t,n,r){let i=r??new e(4),o=t[0],a=t[1],s=t[2],u=t[3],l=n[0],c=n[1],h=n[2],f=n[3];return i[0]=o*f+u*l+a*h-s*c,i[1]=a*f+u*c+s*l-o*h,i[2]=s*f+u*h+o*c-a*l,i[3]=u*f-o*l-a*c-s*h,i}function o(t,n,r,i){let o,a;let s=i??new e(4),u=t[0],l=t[1],c=t[2],h=t[3],f=n[0],v=n[1],d=n[2],m=n[3],w=u*f+l*v+c*d+h*m;if(w<0&&(w=-w,f=-f,v=-v,d=-d,m=-m),1-w>1e-6){let e=Math.acos(w),t=Math.sin(e);o=Math.sin((1-r)*e)/t,a=Math.sin(r*e)/t}else o=1-r,a=r;return s[0]=o*u+a*f,s[1]=o*l+a*v,s[2]=o*c+a*d,s[3]=o*h+a*m,s}function a(t,n){let r=n??new e(4);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r}function s(t,n,r){let i=r??new e(4);return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],i[3]=t[3]-n[3],i}function u(t,n,r){let i=r??new e(4);return i[0]=t[0]*n,i[1]=t[1]*n,i[2]=t[2]*n,i[3]=t[3]*n,i}function l(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function c(e){let t=e[0],n=e[1],r=e[2],i=e[3];return Math.sqrt(t*t+n*n+r*r+i*i)}function h(e){let t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i}function f(t,n){let r=n??new e(4),i=t[0],o=t[1],a=t[2],s=t[3],u=Math.sqrt(i*i+o*o+a*a+s*s);return u>1e-5?(r[0]=i/u,r[1]=o/u,r[2]=a/u,r[3]=s/u):(r[0]=0,r[1]=0,r[2]=0,r[3]=1),r}let v=t.create(),d=t.create(),m=t.create(),w=new e(4),p=new e(4);return{create:n,fromValues:n,set:function(t,n,r,i,o){let a=o??new e(4);return a[0]=t,a[1]=n,a[2]=r,a[3]=i,a},fromAxisAngle:r,toAxisAngle:function(e,n){let r=n??t.create(3),i=2*Math.acos(e[3]),o=Math.sin(.5*i);return o>1e-6?(r[0]=e[0]/o,r[1]=e[1]/o,r[2]=e[2]/o):(r[0]=1,r[1]=0,r[2]=0),{angle:i,axis:r}},angle:function(e,t){let n=l(e,t);return Math.acos(2*n*n-1)},multiply:i,mul:i,rotateX:function(t,n,r){let i=r??new e(4),o=.5*n,a=t[0],s=t[1],u=t[2],l=t[3],c=Math.sin(o),h=Math.cos(o);return i[0]=a*h+l*c,i[1]=s*h+u*c,i[2]=u*h-s*c,i[3]=l*h-a*c,i},rotateY:function(t,n,r){let i=r??new e(4),o=.5*n,a=t[0],s=t[1],u=t[2],l=t[3],c=Math.sin(o),h=Math.cos(o);return i[0]=a*h-u*c,i[1]=s*h+l*c,i[2]=u*h+a*c,i[3]=l*h-s*c,i},rotateZ:function(t,n,r){let i=r??new e(4),o=.5*n,a=t[0],s=t[1],u=t[2],l=t[3],c=Math.sin(o),h=Math.cos(o);return i[0]=a*h+s*c,i[1]=s*h-a*c,i[2]=u*h+l*c,i[3]=l*h-u*c,i},slerp:o,inverse:function(t,n){let r=n??new e(4),i=t[0],o=t[1],a=t[2],s=t[3],u=i*i+o*o+a*a+s*s,l=u?1/u:0;return r[0]=-i*l,r[1]=-o*l,r[2]=-a*l,r[3]=s*l,r},conjugate:function(t,n){let r=n??new e(4);return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r[3]=t[3],r},fromMat:function(t,n){let r=n??new e(4),i=t[0]+t[5]+t[10];if(i>0){let e=Math.sqrt(i+1);r[3]=.5*e;let n=.5/e;r[0]=(t[6]-t[9])*n,r[1]=(t[8]-t[2])*n,r[2]=(t[1]-t[4])*n}else{let e=0;t[5]>t[0]&&(e=1),t[10]>t[4*e+e]&&(e=2);let n=(e+1)%3,i=(e+2)%3,o=Math.sqrt(t[4*e+e]-t[4*n+n]-t[4*i+i]+1);r[e]=.5*o;let a=.5/o;r[3]=(t[4*n+i]-t[4*i+n])*a,r[n]=(t[4*n+e]+t[4*e+n])*a,r[i]=(t[4*i+e]+t[4*e+i])*a}return r},fromEuler:function(t,n,r,i,o){let a=o??new e(4),s=.5*t,u=.5*n,l=.5*r,c=Math.sin(s),h=Math.cos(s),f=Math.sin(u),v=Math.cos(u),d=Math.sin(l),m=Math.cos(l);switch(i){case"xyz":a[0]=c*v*m+h*f*d,a[1]=h*f*m-c*v*d,a[2]=h*v*d+c*f*m,a[3]=h*v*m-c*f*d;break;case"xzy":a[0]=c*v*m-h*f*d,a[1]=h*f*m-c*v*d,a[2]=h*v*d+c*f*m,a[3]=h*v*m+c*f*d;break;case"yxz":a[0]=c*v*m+h*f*d,a[1]=h*f*m-c*v*d,a[2]=h*v*d-c*f*m,a[3]=h*v*m+c*f*d;break;case"yzx":a[0]=c*v*m+h*f*d,a[1]=h*f*m+c*v*d,a[2]=h*v*d-c*f*m,a[3]=h*v*m-c*f*d;break;case"zxy":a[0]=c*v*m-h*f*d,a[1]=h*f*m+c*v*d,a[2]=h*v*d+c*f*m,a[3]=h*v*m-c*f*d;break;case"zyx":a[0]=c*v*m-h*f*d,a[1]=h*f*m+c*v*d,a[2]=h*v*d-c*f*m,a[3]=h*v*m+c*f*d;break;default:throw Error(`Unknown rotation order: ${i}`)}return a},copy:a,clone:a,add:function(t,n,r){let i=r??new e(4);return i[0]=t[0]+n[0],i[1]=t[1]+n[1],i[2]=t[2]+n[2],i[3]=t[3]+n[3],i},subtract:s,sub:s,mulScalar:u,scale:u,divScalar:function(t,n,r){let i=r??new e(4);return i[0]=t[0]/n,i[1]=t[1]/n,i[2]=t[2]/n,i[3]=t[3]/n,i},dot:l,lerp:function(t,n,r,i){let o=i??new e(4);return o[0]=t[0]+r*(n[0]-t[0]),o[1]=t[1]+r*(n[1]-t[1]),o[2]=t[2]+r*(n[2]-t[2]),o[3]=t[3]+r*(n[3]-t[3]),o},length:c,len:c,lengthSq:h,lenSq:h,normalize:f,equalsApproximately:function(e,t){return 1e-6>Math.abs(e[0]-t[0])&&1e-6>Math.abs(e[1]-t[1])&&1e-6>Math.abs(e[2]-t[2])&&1e-6>Math.abs(e[3]-t[3])},equals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},identity:function(t){let n=t??new e(4);return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n},rotationTo:function(n,i,o){let a=o??new e(4),s=t.dot(n,i);return s<-.999999?(t.cross(d,n,v),1e-6>t.len(v)&&t.cross(m,n,v),t.normalize(v,v),r(v,Math.PI,a),a):s>.999999?(a[0]=0,a[1]=0,a[2]=0,a[3]=1,a):(t.cross(n,i,v),a[0]=v[0],a[1]=v[1],a[2]=v[2],a[3]=1+s,f(a,a))},sqlerp:function(t,n,r,i,a,s){let u=s??new e(4);return o(t,i,a,w),o(n,r,a,p),o(w,p,2*a*(1-a),u),u}}}(n),M.set(n,u)),u),vec2:w(r),vec3:b(i),vec4:((l=x.get(o))||(l=function(e){function t(t,n,r,i){let o=new e(4);return void 0!==t&&(o[0]=t,void 0!==n&&(o[1]=n,void 0!==r&&(o[2]=r,void 0!==i&&(o[3]=i)))),o}function n(t,n,r){let i=r??new e(4);return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],i[3]=t[3]-n[3],i}function r(t,n,r,i){let o=i??new e(4);return o[0]=t[0]+r*(n[0]-t[0]),o[1]=t[1]+r*(n[1]-t[1]),o[2]=t[2]+r*(n[2]-t[2]),o[3]=t[3]+r*(n[3]-t[3]),o}function i(t,n,r){let i=r??new e(4);return i[0]=t[0]*n,i[1]=t[1]*n,i[2]=t[2]*n,i[3]=t[3]*n,i}function o(t,n){let r=n??new e(4);return r[0]=1/t[0],r[1]=1/t[1],r[2]=1/t[2],r[3]=1/t[3],r}function a(e){let t=e[0],n=e[1],r=e[2],i=e[3];return Math.sqrt(t*t+n*n+r*r+i*i)}function s(e){let t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i}function u(e,t){let n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(n*n+r*r+i*i+o*o)}function l(e,t){let n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return n*n+r*r+i*i+o*o}function c(t,n){let r=n??new e(4),i=t[0],o=t[1],a=t[2],s=t[3],u=Math.sqrt(i*i+o*o+a*a+s*s);return u>1e-5?(r[0]=i/u,r[1]=o/u,r[2]=a/u,r[3]=s/u):(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function h(t,n){let r=n??new e(4);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r}function f(t,n,r){let i=r??new e(4);return i[0]=t[0]*n[0],i[1]=t[1]*n[1],i[2]=t[2]*n[2],i[3]=t[3]*n[3],i}function v(t,n,r){let i=r??new e(4);return i[0]=t[0]/n[0],i[1]=t[1]/n[1],i[2]=t[2]/n[2],i[3]=t[3]/n[3],i}function d(t,n,r){let o=r??new e(4);return c(t,o),i(o,n,o)}return{create:t,fromValues:t,set:function(t,n,r,i,o){let a=o??new e(4);return a[0]=t,a[1]=n,a[2]=r,a[3]=i,a},ceil:function(t,n){let r=n??new e(4);return r[0]=Math.ceil(t[0]),r[1]=Math.ceil(t[1]),r[2]=Math.ceil(t[2]),r[3]=Math.ceil(t[3]),r},floor:function(t,n){let r=n??new e(4);return r[0]=Math.floor(t[0]),r[1]=Math.floor(t[1]),r[2]=Math.floor(t[2]),r[3]=Math.floor(t[3]),r},round:function(t,n){let r=n??new e(4);return r[0]=Math.round(t[0]),r[1]=Math.round(t[1]),r[2]=Math.round(t[2]),r[3]=Math.round(t[3]),r},clamp:function(t,n=0,r=1,i){let o=i??new e(4);return o[0]=Math.min(r,Math.max(n,t[0])),o[1]=Math.min(r,Math.max(n,t[1])),o[2]=Math.min(r,Math.max(n,t[2])),o[3]=Math.min(r,Math.max(n,t[3])),o},add:function(t,n,r){let i=r??new e(4);return i[0]=t[0]+n[0],i[1]=t[1]+n[1],i[2]=t[2]+n[2],i[3]=t[3]+n[3],i},addScaled:function(t,n,r,i){let o=i??new e(4);return o[0]=t[0]+n[0]*r,o[1]=t[1]+n[1]*r,o[2]=t[2]+n[2]*r,o[3]=t[3]+n[3]*r,o},subtract:n,sub:n,equalsApproximately:function(e,t){return 1e-6>Math.abs(e[0]-t[0])&&1e-6>Math.abs(e[1]-t[1])&&1e-6>Math.abs(e[2]-t[2])&&1e-6>Math.abs(e[3]-t[3])},equals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},lerp:r,lerpV:function(t,n,r,i){let o=i??new e(4);return o[0]=t[0]+r[0]*(n[0]-t[0]),o[1]=t[1]+r[1]*(n[1]-t[1]),o[2]=t[2]+r[2]*(n[2]-t[2]),o[3]=t[3]+r[3]*(n[3]-t[3]),o},max:function(t,n,r){let i=r??new e(4);return i[0]=Math.max(t[0],n[0]),i[1]=Math.max(t[1],n[1]),i[2]=Math.max(t[2],n[2]),i[3]=Math.max(t[3],n[3]),i},min:function(t,n,r){let i=r??new e(4);return i[0]=Math.min(t[0],n[0]),i[1]=Math.min(t[1],n[1]),i[2]=Math.min(t[2],n[2]),i[3]=Math.min(t[3],n[3]),i},mulScalar:i,scale:i,divScalar:function(t,n,r){let i=r??new e(4);return i[0]=t[0]/n,i[1]=t[1]/n,i[2]=t[2]/n,i[3]=t[3]/n,i},inverse:o,invert:o,dot:function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},length:a,len:a,lengthSq:s,lenSq:s,distance:u,dist:u,distanceSq:l,distSq:l,normalize:c,negate:function(t,n){let r=n??new e(4);return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r[3]=-t[3],r},copy:h,clone:h,multiply:f,mul:f,divide:v,div:v,zero:function(t){let n=t??new e(4);return n[0]=0,n[1]=0,n[2]=0,n[3]=0,n},transformMat4:function(t,n,r){let i=r??new e(4),o=t[0],a=t[1],s=t[2],u=t[3];return i[0]=n[0]*o+n[4]*a+n[8]*s+n[12]*u,i[1]=n[1]*o+n[5]*a+n[9]*s+n[13]*u,i[2]=n[2]*o+n[6]*a+n[10]*s+n[14]*u,i[3]=n[3]*o+n[7]*a+n[11]*s+n[15]*u,i},setLength:d,truncate:function(t,n,r){let i=r??new e(4);return a(t)>n?d(t,n,i):h(t,i)},midpoint:function(t,n,i){return r(t,n,.5,i??new e(4))}}}(o),x.set(o,l)),l)}}let{mat3:S,mat4:C,quat:A,vec2:B,vec3:T,vec4:E}=P(Float32Array,Float32Array,Float32Array,Float32Array,Float32Array,Float32Array),{mat3:z,mat4:k,quat:R,vec2:I,vec3:U,vec4:D}=P(Float64Array,Float64Array,Float64Array,Float64Array,Float64Array,Float64Array),{mat3:F,mat4:O,quat:q,vec2:L,vec3:_,vec4:N}=P(d,Array,Array,Array,Array,Array);function G(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,i)}function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var X=function(){var e,t;function n(e,t,r,i,o){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),j(this,"htmlCanvas",void 0),j(this,"canvasContext",void 0),j(this,"gpuAdapter",void 0),j(this,"device",void 0),j(this,"gpuBindGroup",void 0),j(this,"objectRenderPipeline",void 0),j(this,"backgroundRenderPipeline",void 0),j(this,"renderPassDescriptor",void 0),j(this,"cubeVertexBuffer",void 0),j(this,"cubeIndexBuffer",void 0),j(this,"sphereVertexBuffer",void 0),j(this,"sphereIndexBuffer",void 0),j(this,"texture",void 0),j(this,"textureSampler",void 0),j(this,"modelMatrices",void 0),j(this,"transformationUniform",void 0),j(this,"brightnessUniform",void 0),j(this,"colorRotateUnifrom",void 0),j(this,"lightDirectionUniform",void 0),j(this,"commandEncoder",void 0),j(this,"renderPassEncoder",void 0),this.htmlCanvas=e,this.gpuAdapter=t,this.device=r,this.canvasContext=this.htmlCanvas.getContext("webgpu"),this.canvasContext.configure({device:this.device,format:n.COLOR_FORMAT,usage:GPUTextureUsage.RENDER_ATTACHMENT}),this.renderPassDescriptor={colorAttachments:[{view:this.createMultisampleTexture(),resolveTarget:null,loadOp:"clear",clearValue:[.3,.3,.3,1],storeOp:"store"}],depthStencilAttachment:{view:this.createDepthStencilView(),depthLoadOp:"clear",depthClearValue:1,depthStoreOp:"store",stencilLoadOp:"clear",stencilClearValue:0,stencilStoreOp:"store"}},this.cubeVertexBuffer=this.device.createBuffer({size:s.cube.vertices.byteLength,usage:GPUBufferUsage.VERTEX,mappedAtCreation:!0}),new Float32Array(this.cubeVertexBuffer.getMappedRange()).set(s.cube.vertices),this.cubeVertexBuffer.unmap(),this.cubeIndexBuffer=this.device.createBuffer({size:s.cube.indices.byteLength,usage:GPUBufferUsage.INDEX,mappedAtCreation:!0}),new Uint16Array(this.cubeIndexBuffer.getMappedRange()).set(s.cube.indices),this.cubeIndexBuffer.unmap(),this.sphereVertexBuffer=this.device.createBuffer({size:s.sphere.vertices.byteLength,usage:GPUBufferUsage.VERTEX,mappedAtCreation:!0}),new Float32Array(this.sphereVertexBuffer.getMappedRange()).set(s.sphere.vertices),this.sphereVertexBuffer.unmap(),this.sphereIndexBuffer=this.device.createBuffer({size:s.sphere.indices.byteLength,usage:GPUBufferUsage.INDEX,mappedAtCreation:!0}),new Uint16Array(this.sphereIndexBuffer.getMappedRange()).set(s.sphere.indices),this.sphereIndexBuffer.unmap();var a={size:{width:o[0].width,height:o[0].height},format:n.COLOR_FORMAT,usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT,mipLevelCount:o.length};this.texture=this.device.createTexture(a);for(var u=0;u<o.length;u++)this.device.queue.copyExternalImageToTexture({source:o[u]},{texture:this.texture,mipLevel:u},{width:o[u].width,height:o[u].height});this.textureSampler=this.device.createSampler({addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"nearest",maxAnisotropy:1});var l=new Float32Array((1+s.sphere.vertixCount)*16),c=C.identity();C.translate(c,[0,0,-500],c),C.scale(c,[20,20,20],c),l.set(c,0);for(var h=0;h<s.sphere.vertixCount;h++)C.identity(c),C.translate(c,[200*s.sphere.vertices[8*h],200*s.sphere.vertices[8*h+1],200*s.sphere.vertices[8*h+2]-500],c),C.scale(c,[.5,.5,.5],c),l.set(c,(h+1)*16);this.modelMatrices=this.device.createBuffer({size:(1+s.sphere.vertixCount+n.OBJECT_BUFFER_SIZE)*64,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST,mappedAtCreation:!0}),new Float32Array(this.modelMatrices.getMappedRange()).set(l),this.modelMatrices.unmap(),this.transformationUniform=r.createBuffer({size:128,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.brightnessUniform=r.createBuffer({size:4,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.colorRotateUnifrom=r.createBuffer({size:4,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.lightDirectionUniform=r.createBuffer({size:12,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST});var f=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.FRAGMENT,texture:{}},{binding:1,visibility:GPUShaderStage.FRAGMENT,sampler:{}},{binding:2,visibility:GPUShaderStage.VERTEX,buffer:{type:"read-only-storage",hasDynamicOffset:!1}},{binding:3,visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,buffer:{}},{binding:4,visibility:GPUShaderStage.FRAGMENT,buffer:{}},{binding:5,visibility:GPUShaderStage.FRAGMENT,buffer:{}},{binding:6,visibility:GPUShaderStage.FRAGMENT,buffer:{}}]});this.gpuBindGroup=this.device.createBindGroup({layout:f,entries:[{binding:0,resource:this.texture.createView({format:n.COLOR_FORMAT,dimension:"2d",aspect:"all",baseMipLevel:0,mipLevelCount:1,baseArrayLayer:0,arrayLayerCount:1})},{binding:1,resource:this.textureSampler},{binding:2,resource:{buffer:this.modelMatrices}},{binding:3,resource:{buffer:this.transformationUniform}},{binding:4,resource:{buffer:this.brightnessUniform}},{binding:5,resource:{buffer:this.colorRotateUnifrom}},{binding:6,resource:{buffer:this.lightDirectionUniform}}]});var v={arrayStride:32,attributes:[{format:"float32x3",shaderLocation:0,offset:0},{format:"float32x3",shaderLocation:1,offset:12},{format:"float32x2",shaderLocation:2,offset:24}]};this.objectRenderPipeline=this.device.createRenderPipeline({layout:this.device.createPipelineLayout({bindGroupLayouts:[f]}),vertex:{module:i,entryPoint:"vertex_main",buffers:[v]},fragment:{module:i,entryPoint:"fragment_main",targets:[{format:n.COLOR_FORMAT}]},depthStencil:{format:n.DEPTH_FORMAT,depthWriteEnabled:!0,depthCompare:"less"},primitive:{topology:"triangle-list",cullMode:"back",frontFace:"cw"},multisample:{count:n.SAMPLE_COUNT}}),this.backgroundRenderPipeline=this.device.createRenderPipeline({layout:this.device.createPipelineLayout({bindGroupLayouts:[f]}),vertex:{module:i,entryPoint:"background_vertex_main",buffers:[v]},fragment:{module:i,entryPoint:"background_fragment_main",targets:[{format:n.COLOR_FORMAT}]},depthStencil:{format:n.DEPTH_FORMAT,depthWriteEnabled:!0,depthCompare:"less-equal"},primitive:{topology:"triangle-list",cullMode:"back",frontFace:"ccw"},multisample:{count:n.SAMPLE_COUNT}})}return e=[{key:"renderStart",value:function(){this.renderPassDescriptor.colorAttachments[0].resolveTarget=this.canvasContext.getCurrentTexture().createView(),this.commandEncoder=this.device.createCommandEncoder(),this.renderPassEncoder=this.commandEncoder.beginRenderPass(this.renderPassDescriptor),this.renderPassEncoder.setBindGroup(0,this.gpuBindGroup)}},{key:"setObjectShader",value:function(){this.renderPassEncoder.setPipeline(this.objectRenderPipeline)}},{key:"renderLittleSphere",value:function(){this.renderPassEncoder.setVertexBuffer(0,this.sphereVertexBuffer),this.renderPassEncoder.setIndexBuffer(this.sphereIndexBuffer,"uint16"),this.renderPassEncoder.drawIndexed(s.sphere.indices.length,1)}},{key:"renderSphereCubes",value:function(){this.renderPassEncoder.setVertexBuffer(0,this.cubeVertexBuffer),this.renderPassEncoder.setIndexBuffer(this.cubeIndexBuffer,"uint16"),this.renderPassEncoder.drawIndexed(s.cube.indices.length,s.sphere.vertixCount,0,0,1)}},{key:"renderDigits",value:function(e){this.device.queue.writeBuffer(this.modelMatrices,(1+s.sphere.vertixCount)*64,e),this.renderPassEncoder.setVertexBuffer(0,this.cubeVertexBuffer),this.renderPassEncoder.setIndexBuffer(this.cubeIndexBuffer,"uint16"),this.renderPassEncoder.drawIndexed(s.cube.indices.length,e.byteLength/64,0,0,1+s.sphere.vertixCount)}},{key:"setBackgroundShader",value:function(){this.renderPassEncoder.setPipeline(this.backgroundRenderPipeline)}},{key:"renderBeckgound",value:function(){this.renderPassEncoder.setVertexBuffer(0,this.sphereVertexBuffer),this.renderPassEncoder.setIndexBuffer(this.sphereIndexBuffer,"uint16"),this.renderPassEncoder.drawIndexed(s.sphere.indices.length,1)}},{key:"renderEnd",value:function(){this.renderPassEncoder.end(),this.device.queue.submit([this.commandEncoder.finish()])}},{key:"view",set:function(e){this.device.queue.writeBuffer(this.transformationUniform,0,e)}},{key:"projection",set:function(e){this.device.queue.writeBuffer(this.transformationUniform,64,e)}},{key:"brightness",set:function(e){this.device.queue.writeBuffer(this.brightnessUniform,0,new Float32Array([e]))}},{key:"colorRotate",set:function(e){this.device.queue.writeBuffer(this.colorRotateUnifrom,0,new Float32Array([e]))}},{key:"lightDirection",set:function(e){this.device.queue.writeBuffer(this.lightDirectionUniform,0,e)}},{key:"renewRenderTextures",value:function(){this.renderPassDescriptor.depthStencilAttachment.view=this.createDepthStencilView(),this.renderPassDescriptor.colorAttachments[0].view=this.createMultisampleTexture()}},{key:"createDepthStencilView",value:function(){return this.device.createTexture({size:{width:this.htmlCanvas.width,height:this.htmlCanvas.height,depthOrArrayLayers:1},format:n.DEPTH_FORMAT,usage:GPUTextureUsage.RENDER_ATTACHMENT,sampleCount:n.SAMPLE_COUNT}).createView()}},{key:"createMultisampleTexture",value:function(){return this.device.createTexture({size:{width:this.htmlCanvas.width,height:this.htmlCanvas.height,depthOrArrayLayers:1},format:n.COLOR_FORMAT,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.SAMPLED,sampleCount:n.SAMPLE_COUNT}).createView()}}],t=[{key:"create",value:function(e){var t;return(t=function(){var t,r,i,o,a,s,u,l,c,h,f;return function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,function(d){switch(d.label){case 0:if(void 0===navigator.gpu)throw Error("WebGPU is not supported/enabled in your browser");return[4,navigator.gpu.requestAdapter()];case 1:return[4,(t=d.sent()).requestDevice()];case 2:return[4,(i=(r=d.sent()).createShaderModule({code:"struct Vertex {\n    @location(0) position: vec3<f32>,\n    @location(1) normal: vec3<f32>,\n    @location(2) texturePosition: vec2<f32>\n}\n\nstruct Fragment {\n    @builtin(position) position: vec4<f32>,\n    @location(0) localPosition: vec3<f32>,\n    @location(1) normal: vec3<f32>,\n    @location(2) texturePosition: vec2<f32>\n}\n\nstruct BackgroundFragment {\n    @builtin(position) position: vec4<f32>,\n    @location(0) yPosition: f32,\n    @location(1) normal: vec3<f32>,\n    @location(2) texturePosition: vec2<f32>\n}\n\n\nstruct Tranformation {\n    view: mat4x4<f32>,\n    projection: mat4x4<f32>\n}\n\n\n@group(0) @binding(0) var theTexture: texture_2d<f32>;\n@group(0) @binding(1) var theSampler: sampler;\n\n@group(0) @binding(2) var<storage, read> modelBuffer: array<mat4x4<f32>>;\n\n@group(0) @binding(3) var<uniform> tranformation: Tranformation;\n@group(0) @binding(4) var<uniform> brightness: f32;\n@group(0) @binding(5) var<uniform> colorRotate: f32;\n@group(0) @binding(6) var<uniform> lightDirection: vec3<f32>;\n\n\n@vertex\nfn vertex_main(@builtin(instance_index) index: u32, vertex: Vertex) -> Fragment {\n    var result: Fragment;\n    \n    result.localPosition = vertex.position;\n    result.normal = vertex.normal;\n    result.texturePosition = vertex.texturePosition;\n    result.position = tranformation.projection * tranformation.view * modelBuffer[index] * vec4(vertex.position, 1.0);\n    \n    return result;\n}\n\n@fragment\nfn fragment_main(fragment: Fragment) -> @location(0) vec4<f32> {\n    // hsv color\n\n    const MIN: f32 = 1.0;\n    const MAX: f32 = 3.0;\n    const SPAN: f32 = MAX - MIN;\n    let squareDistance: f32 = fragment.localPosition.x * fragment.localPosition.x + fragment.localPosition.y * fragment.localPosition.y + fragment.localPosition.z * fragment.localPosition.z;\n\n    var h: f32 = ((squareDistance - MIN) / SPAN + colorRotate);\n    if (h > 1.0) { h -= 1.0; }\n    let s: f32 = 1.0;\n    let v: f32 = brightness;\n\n    let hsvColor: vec3<f32> = hsv2rgb(vec3<f32>(h, s, v));\n\n\n\n    // texture\n\n    const TEXTURE_OPACITY: f32 = 0.5;\n    let textureColor: vec4<f32> = textureSample(theTexture, theSampler, fragment.texturePosition);\n    let opacity: f32 = TEXTURE_OPACITY * textureColor.a;\n\n\n\n    // Phong\n\n    const AMBIENT: f32 = 0.5;\n    const DIFFUSE: f32 = 2.0;\n    const SPECULAR: f32 = 4.0;\n    const SPECULAR_SHININESS: f32 = 64.0;\n\n    let ambient: f32 = AMBIENT;\n\n    let diffuseAngle: f32 = max(dot(fragment.normal, lightDirection), 0.0);\n    let diffuse: f32 = diffuseAngle * DIFFUSE;\n\n    let viewDirection: vec3<f32> = mat3x3<f32>(tranformation.view[0].xyz, tranformation.view[1].xyz, tranformation.view[2].xyz) * vec3(0.0, 0.0, 1.0);\n    let reflectDirection: vec3<f32> = reflect(-lightDirection, fragment.normal);\n    let specularAngle: f32 = max(dot(viewDirection, reflectDirection), 0.0);\n    let specular: f32 = pow(specularAngle, SPECULAR_SHININESS) * SPECULAR;\n\n    let strength: f32 = ambient + diffuse + specular;\n\n\n\n    let hsvPart: vec3<f32> = (1 - opacity) * hsvColor;\n    let texturePart: vec3<f32> = opacity * textureColor.rgb;\n    let color: vec3<f32> = (hsvPart + texturePart) * strength;\n    return vec4(color, 1.0);\n}\n\nfn hsv2rgb(c: vec3<f32>) -> vec3<f32> {\n    let k: vec4<f32> = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    let p: vec3<f32> = abs(fract(c.xxx + k.xyz) * 6.0 - k.www);\n    return c.z * mix(k.xxx, clamp(p - k.xxx, vec3<f32>(0.0), vec3<f32>(1.0)), c.y);\n}\n\n\n@vertex\nfn background_vertex_main(vertex: Vertex) -> BackgroundFragment {\n    var result: BackgroundFragment;\n\n    result.yPosition = vertex.position.y;\n    result.normal = vertex.normal;\n    result.texturePosition = vertex.texturePosition;\n    \n    let viewRotation = mat3x3<f32>(tranformation.view[0].xyz, tranformation.view[1].xyz, tranformation.view[2].xyz);\n    let positionWithDepth = tranformation.projection * vec4(viewRotation * vertex.position, 1.0);\n    result.position = positionWithDepth.xyww;\n\n    return result;\n}\n\n@fragment\nfn background_fragment_main(fragment: BackgroundFragment) -> @location(0) vec4<f32> {\n    let textureColor: vec4<f32> = textureSample(theTexture, theSampler, fragment.texturePosition);\n    \n    let brightness: f32 = (fragment.yPosition + 6.0) / 8.0;\n    let backgroundColor: vec3<f32> = vec3(brightness, brightness, 0.9);\n\n    let filledColor: vec3<f32> = mix(backgroundColor, textureColor.rgb, textureColor.a);\n    let tintedColor = mix(filledColor, backgroundColor, 0.8);\n\n    \n    // Phong\n\n    const AMBIENT: f32 = 1.0;\n    const DIFFUSE: f32 = 0.6;\n    const SPECULAR: f32 = 1.0;\n    const SPECULAR_SHININESS: f32 = 32.0;\n\n    let ambient: f32 = AMBIENT;\n\n    let diffuseAngle: f32 = max(dot(fragment.normal, lightDirection), 0.0);\n    let diffuse: f32 = diffuseAngle * DIFFUSE;\n\n    let viewDirection: vec3<f32> = mat3x3<f32>(tranformation.view[0].xyz, tranformation.view[1].xyz, tranformation.view[2].xyz) * vec3(0.0, 0.0, 1.0);\n    let reflectDirection: vec3<f32> = reflect(-lightDirection, fragment.normal);\n    let specularAngle: f32 = max(dot(viewDirection, reflectDirection), 0.0);\n    let specular: f32 = pow(specularAngle, SPECULAR_SHININESS) * SPECULAR;\n\n    let strength: f32 = ambient + diffuse + specular;\n\n    \n    let resultColor: vec3<f32> = tintedColor * strength;\n    return vec4(resultColor, 1.0);\n}\n"})).getCompilationInfo()];case 3:o=d.sent(),a=!0,s=!1,u=void 0;try{for(l=o.messages[Symbol.iterator]();!(a=(c=l.next()).done);a=!0)if(h=c.value,"error"===h.type)throw Error("aborted => shader module compilation error(s)")}catch(e){s=!0,u=e}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}return[4,new v().loadSvgMipmaps("img/rose.svg",4096,4096,6)];case 4:return f=d.sent(),[2,new n(e,t,r,i,f)]}})},function(){var e=this,n=arguments;return new Promise(function(r,i){var o=t.apply(e,n);function a(e){G(o,r,i,a,s,"next",e)}function s(e){G(o,r,i,a,s,"throw",e)}a(void 0)})})()}}],e&&V(n.prototype,e),t&&V(n,t),n}();function Y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function H(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}j(X,"COLOR_FORMAT","bgra8unorm"),j(X,"DEPTH_FORMAT","depth24plus-stencil8"),j(X,"SAMPLE_COUNT",4),j(X,"OBJECT_BUFFER_SIZE",512);var K=function(){var e,t;function n(e,t,r,i,o,a){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),H(this,"ax",void 0),H(this,"bx",void 0),H(this,"ay",void 0),H(this,"by",void 0),H(this,"az",void 0),H(this,"bz",void 0),H(this,"isAx",void 0),H(this,"isBx",void 0),H(this,"isAy",void 0),H(this,"isBy",void 0),H(this,"isAz",void 0),H(this,"isBz",void 0),this.ax=e,this.bx=t,this.ay=r,this.by=i,this.az=o,this.bz=a}return e=[{key:"hasCollision",value:function(e){this.isAx=this.ax<e.ax&&e.ax<this.bx,this.isBx=this.ax<e.bx&&e.bx<this.bx;var t=e.ax<=this.ax&&this.bx<=e.bx;if(!this.isAx&&!this.isBx&&!t)return!1;this.isAy=this.ay<e.ay&&e.ay<this.by,this.isBy=this.ay<e.by&&e.by<this.by;var n=e.ay<=this.ay&&this.by<=e.by;if(!this.isAy&&!this.isBy&&!n)return!1;this.isAz=this.az<e.az&&e.az<this.bz,this.isBz=this.az<e.bz&&e.bz<this.bz;var r=e.az<=this.az&&this.bz<=e.bz;return!!this.isAz||!!this.isBz||!!r}},{key:"handleCollision",value:function(e){function t(e,t,n,r,i,o){if(e&&!t)return r-i;if(!e&&t)return n-o;var a=o-n,s=r-i;return a<s?-a:s}var n=t(this.isAx,this.isBx,this.ax,this.bx,e.ax,e.bx),r=t(this.isAy,this.isBy,this.ay,this.by,e.ay,e.by),i=t(this.isAz,this.isBz,this.az,this.bz,e.az,e.bz);if(Math.abs(n)<Math.abs(r))return Math.abs(n)<Math.abs(i)?T.create(n,0,0):T.create(0,0,i);return Math.abs(r)<Math.abs(i)?T.create(0,r,0):T.create(0,0,i)}}],t=[{key:"create",value:function(e,t){return new n(e[0]-t,e[0]+t,e[1]-t,e[1]+t,e[2]-t,e[2]+t)}}],e&&Y(n.prototype,e),t&&Y(n,t),n}();function Z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var W=function(){var e;function t(e,n,r){var i=this;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t),Z(this,"renderer",void 0),Z(this,"htmlCanvas",void 0),Z(this,"dialogButton",void 0),Z(this,"modelBuffer",new Float32Array(16*X.OBJECT_BUFFER_SIZE)),Z(this,"boxColliderBuffer",Array(512)),Z(this,"boxColliderCount",0),Z(this,"viewPos",void 0),Z(this,"viewRotation",void 0),Z(this,"view",void 0),Z(this,"projectionFieldOfView",1),Z(this,"projection",void 0),Z(this,"brightnessTimer",0),Z(this,"colorTimer",0),Z(this,"lightDirectionTimer",0),Z(this,"timeout",void 0),Z(this,"moveSpeed",void 0),Z(this,"mouseSensitivity",1),Z(this,"gameLoop",function(){i.windowResized&&(i.renderer.renewRenderTextures(),i.windowResized=!1);var e=i.createDigitModels(),n=i.moveFast?.1*t.SPEED_MULTIPLIER*i.moveSpeed:.1*i.moveSpeed,r=-Math.sin(i.viewRotation[0])*n,o=Math.cos(i.viewRotation[0])*n;i.moveForward&&(i.viewPos[0]+=r,i.viewPos[2]+=o),i.moveBackward&&(i.viewPos[0]-=r,i.viewPos[2]-=o),i.moveLeft&&(i.viewPos[0]+=o,i.viewPos[2]-=r),i.moveRight&&(i.viewPos[0]-=o,i.viewPos[2]+=r),i.moveUp&&(i.viewPos[1]-=n),i.moveDown&&(i.viewPos[1]+=n),i.handleCameraCollision(),C.identity(i.view),C.rotateX(i.view,i.viewRotation[1],i.view),C.rotateY(i.view,i.viewRotation[0],i.view),C.translate(i.view,i.viewPos,i.view),i.renderer.view=i.view,i.renderer.projection=i.projection,i.brightnessTimer+=.005,i.brightnessTimer>2*Math.PI&&(i.brightnessTimer-=2*Math.PI);var a=Math.sin(i.brightnessTimer)/4+.75;i.renderer.brightness=a,i.colorTimer+=.001,i.colorTimer>1&&(i.colorTimer-=1),i.renderer.colorRotate=i.colorTimer,i.lightDirectionTimer+=.002,i.lightDirectionTimer>2*Math.PI&&(i.lightDirectionTimer-=2*Math.PI);var s=.25+Math.cos(i.lightDirectionTimer)/8,u=Math.sin(Math.acos(s)),l=Math.cos(i.lightDirectionTimer)*u,c=Math.sin(i.lightDirectionTimer)*u;i.renderer.lightDirection=T.create(l,s,c),i.renderer.renderStart(),i.renderer.setObjectShader(),i.renderer.renderLittleSphere(),i.renderer.renderSphereCubes(),i.renderer.renderDigits(e),i.renderer.setBackgroundShader(),i.renderer.renderBeckgound(),i.renderer.renderEnd(),requestAnimationFrame(i.gameLoop)}),Z(this,"moveForward",!1),Z(this,"moveBackward",!1),Z(this,"moveLeft",!1),Z(this,"moveRight",!1),Z(this,"moveUp",!1),Z(this,"moveDown",!1),Z(this,"moveFast",!1),Z(this,"windowResized",!1),this.renderer=e,this.htmlCanvas=n,this.dialogButton=r;for(var o=0;o<this.boxColliderBuffer.length;o++)this.boxColliderBuffer[o]=new K(0,0,0,0,0,0);this.view=C.identity(),this.viewPos=T.zero(),this.viewPos[2]=-3,this.viewRotation=T.zero(),this.projection=C.create(),this.zoomCamera(0),this.renderer.view=this.view,this.renderer.projection=this.projection;var a=localStorage.getItem("timeout");null!==a?this.timeout=Number.parseInt(a):this.timeout=Date.now()+6e5;var s=localStorage.getItem("moveSpeed");null!==s?this.moveSpeed=Number.parseFloat(s):this.moveSpeed=1;var u=localStorage.getItem("mouseSensitivity");null!==u?this.mouseSensitivity=Number.parseFloat(u):this.mouseSensitivity=1,this.gameLoop()}return e=[{key:"handleCameraCollision",value:function(){if(-25<this.viewPos[1]&&this.viewPos[1]<25&&198<this.viewPos[2]&&this.viewPos[2]<202){for(var e=K.create(this.viewPos,.5),t=0;t<this.boxColliderCount;t++){var n=this.boxColliderBuffer[t];if(n.hasCollision(e)){var r=n.handleCollision(e);this.viewPos[0]+=r[0],this.viewPos[1]+=r[1],this.viewPos[2]+=r[2];break}}return}if(-202<this.viewPos[0]&&this.viewPos[0]<202&&-202<this.viewPos[1]&&this.viewPos[1]<202&&298<this.viewPos[2]&&this.viewPos[2]<702){var i=K.create(this.viewPos,.5);if(K.create(T.create(0,0,500),20).hasCollision(i)){var o=this.viewPos[0]-0,a=this.viewPos[1]-0,u=this.viewPos[2]-500,l=Math.sqrt(o*o+a*a+u*u),c=21-l;if(c<=0)return;this.viewPos[0]+=o/l*c,this.viewPos[1]+=a/l*c,this.viewPos[2]+=u/l*c;return}for(var h=0;h<s.sphere.vertixCount;h++){var f=K.create(T.create(-200*s.sphere.vertices[8*h],-200*s.sphere.vertices[8*h+1],-200*s.sphere.vertices[8*h+2]+500),.5);if(f.hasCollision(i)){var v=f.handleCollision(i);this.viewPos[0]+=v[0],this.viewPos[1]+=v[1],this.viewPos[2]+=v[2];break}}return}}},{key:"createDigitModels",value:function(){var e=this,t=function(e,t){return C.identity(e),C.translate(e,[t,0,-200],e),e},n=function(t){C.translate(t,[0,22,0],t),C.scale(t,[10,1,1],t);var n=e.boxColliderBuffer[e.boxColliderCount++];return n.ax=-t[12]-10,n.bx=-t[12]+10,n.ay=-t[13]-1,n.by=-t[13]+1,n.az=-t[14]-1,n.bz=-t[14]+1,t},r=function(t){C.scale(t,[10,1,1],t);var n=e.boxColliderBuffer[e.boxColliderCount++];return n.ax=-t[12]-10,n.bx=-t[12]+10,n.ay=-t[13]-1,n.by=-t[13]+1,n.az=-t[14]-1,n.bz=-t[14]+1,t},i=function(t){C.translate(t,[0,-22,0],t),C.scale(t,[10,1,1],t);var n=e.boxColliderBuffer[e.boxColliderCount++];return n.ax=-t[12]-10,n.bx=-t[12]+10,n.ay=-t[13]-1,n.by=-t[13]+1,n.az=-t[14]-1,n.bz=-t[14]+1,t},o=function(t){C.translate(t,[-11,11,0],t),C.scale(t,[1,10,1],t);var n=e.boxColliderBuffer[e.boxColliderCount++];return n.ax=-t[12]-1,n.bx=-t[12]+1,n.ay=-t[13]-10,n.by=-t[13]+10,n.az=-t[14]-1,n.bz=-t[14]+1,t},a=function(t){C.translate(t,[11,11,0],t),C.scale(t,[1,10,1],t);var n=e.boxColliderBuffer[e.boxColliderCount++];return n.ax=-t[12]-1,n.bx=-t[12]+1,n.ay=-t[13]-10,n.by=-t[13]+10,n.az=-t[14]-1,n.bz=-t[14]+1,t},s=function(t){C.translate(t,[-11,-11,0],t),C.scale(t,[1,10,1],t);var n=e.boxColliderBuffer[e.boxColliderCount++];return n.ax=-t[12]-1,n.bx=-t[12]+1,n.ay=-t[13]-10,n.by=-t[13]+10,n.az=-t[14]-1,n.bz=-t[14]+1,t},u=function(t){C.translate(t,[11,-11,0],t),C.scale(t,[1,10,1],t);var n=e.boxColliderBuffer[e.boxColliderCount++];return n.ax=-t[12]-1,n.bx=-t[12]+1,n.ay=-t[13]-10,n.by=-t[13]+10,n.az=-t[14]-1,n.bz=-t[14]+1,t};this.boxColliderCount=0;var l=this.timeout-Date.now();if(l<0){var c=this.modelBuffer.slice(96),h=C.create();return c.set(n(t(h,0)),0),c.set(i(t(h,0)),16),c.set(o(t(h,0)),32),c.set(a(t(h,0)),48),c.set(s(t(h,0)),64),c.set(u(t(h,0)),80),this.dialogButton.setAttribute("timeout",""),c.buffer}var f=[],v=0;do{var d=l%10;switch(f.push(d),d){case 0:case 6:case 9:v+=6;break;case 1:v+=2;break;case 2:case 3:case 5:v+=5;break;case 4:v+=4;break;case 7:v+=3;break;case 8:v+=7}l=Math.floor(l/10)}while(l>0);for(var m=this.modelBuffer.slice(16*v),w=C.create(),p=(f.length-1)/2,b=-16,g=0;g<f.length;g++){var y=(p-g)*40;switch(f[g]){case 0:m.set(n(t(w,y)),b+=16),m.set(i(t(w,y)),b+=16),m.set(o(t(w,y)),b+=16),m.set(a(t(w,y)),b+=16),m.set(s(t(w,y)),b+=16),m.set(u(t(w,y)),b+=16);break;case 1:m.set(a(t(w,y)),b+=16),m.set(u(t(w,y)),b+=16);break;case 2:m.set(n(t(w,y)),b+=16),m.set(r(t(w,y)),b+=16),m.set(i(t(w,y)),b+=16),m.set(a(t(w,y)),b+=16),m.set(s(t(w,y)),b+=16);break;case 3:m.set(n(t(w,y)),b+=16),m.set(r(t(w,y)),b+=16),m.set(i(t(w,y)),b+=16),m.set(a(t(w,y)),b+=16),m.set(u(t(w,y)),b+=16);break;case 4:m.set(r(t(w,y)),b+=16),m.set(o(t(w,y)),b+=16),m.set(a(t(w,y)),b+=16),m.set(u(t(w,y)),b+=16);break;case 5:m.set(n(t(w,y)),b+=16),m.set(r(t(w,y)),b+=16),m.set(i(t(w,y)),b+=16),m.set(o(t(w,y)),b+=16),m.set(u(t(w,y)),b+=16);break;case 6:m.set(n(t(w,y)),b+=16),m.set(r(t(w,y)),b+=16),m.set(i(t(w,y)),b+=16),m.set(o(t(w,y)),b+=16),m.set(s(t(w,y)),b+=16),m.set(u(t(w,y)),b+=16);break;case 7:m.set(n(t(w,y)),b+=16),m.set(a(t(w,y)),b+=16),m.set(u(t(w,y)),b+=16);break;case 8:m.set(n(t(w,y)),b+=16),m.set(r(t(w,y)),b+=16),m.set(i(t(w,y)),b+=16),m.set(o(t(w,y)),b+=16),m.set(a(t(w,y)),b+=16),m.set(s(t(w,y)),b+=16),m.set(u(t(w,y)),b+=16);break;case 9:m.set(n(t(w,y)),b+=16),m.set(r(t(w,y)),b+=16),m.set(i(t(w,y)),b+=16),m.set(o(t(w,y)),b+=16),m.set(a(t(w,y)),b+=16),m.set(u(t(w,y)),b+=16)}}return m.buffer}},{key:"setWindowResized",value:function(){this.windowResized=!0}},{key:"rotateCamera",value:function(e,t){var n=.001*this.mouseSensitivity;this.viewRotation[0]+=n*e,this.viewRotation[0]<0?this.viewRotation[0]+=2*Math.PI:this.viewRotation[0]>2*Math.PI&&(this.viewRotation[0]-=2*Math.PI),this.viewRotation[1]+=n*t,this.viewRotation[1]<-Math.PI/2?this.viewRotation[1]=-Math.PI/2:this.viewRotation[1]>Math.PI/2&&(this.viewRotation[1]=Math.PI/2)}},{key:"zoomCamera",value:function(e){this.projectionFieldOfView+=.01*e,this.projectionFieldOfView<.3?this.projectionFieldOfView=.3:this.projectionFieldOfView>1.6&&(this.projectionFieldOfView=1.6),C.perspective(this.projectionFieldOfView,this.htmlCanvas.width/this.htmlCanvas.height,.1,500,this.projection)}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}();Z(W,"SPEED_MULTIPLIER",5);function J(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Q=function(){var e;function t(e,n){var r=this;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t),J(this,"logic",void 0),J(this,"htmlCanvas",void 0),J(this,"onMouseMove",function(e){document.pointerLockElement===r.htmlCanvas&&r.logic.rotateCamera(e.movementX,e.movementY)}),J(this,"onMouseWheel",function(e){r.logic.zoomCamera(e.deltaY)}),J(this,"ctrlPressed",void 0),J(this,"altPressed",void 0),J(this,"onKeyPressed",function(e){r.onKeyTriggered(!0,e)}),J(this,"onKeyReleased",function(e){r.onKeyTriggered(!1,e)}),this.logic=e,this.htmlCanvas=n,this.htmlCanvas.onresize=function(){return r.logic.setWindowResized()},this.htmlCanvas.onclick=function(){return r.htmlCanvas.requestPointerLock()},this.htmlCanvas.onmousemove=this.onMouseMove,document.onwheel=this.onMouseWheel,document.onkeydown=this.onKeyPressed,document.onkeyup=this.onKeyReleased}return e=[{key:"onKeyTriggered",value:function(e,t){switch(t.code){case"KeyW":this.logic.moveForward=e,t.preventDefault();break;case"KeyS":this.logic.moveBackward=e,t.preventDefault();break;case"KeyA":this.logic.moveLeft=e,t.preventDefault();break;case"KeyD":this.logic.moveRight=e,t.preventDefault();break;case"Space":this.logic.moveUp=e,t.preventDefault();break;case"ShiftLeft":this.logic.moveDown=e,t.preventDefault();break;case"ControlLeft":this.logic.moveFast=(this.ctrlPressed=e)||this.altPressed,t.preventDefault();break;case"AltLeft":this.logic.moveFast=(this.altPressed=e)||this.ctrlPressed,t.preventDefault()}}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}();function $(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ee=function e(t,n,r){var i=this;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,e),$(this,"logic",void 0),$(this,"dialogButton",void 0),$(this,"htmlDialog",void 0),$(this,"timerInput",void 0),$(this,"timerButton",void 0),$(this,"moveSpeedInput",void 0),$(this,"moveSpeedLabel",void 0),$(this,"mouseSensitivtyInput",void 0),$(this,"mouseSensitivtyLabel",void 0),$(this,"onDialogButton",function(e){var t=i.logic.timeout-Date.now();i.timerInput.value=t>0?t.toString():"0",i.htmlDialog.showModal()}),$(this,"onDialogClicked",function(e){var t=i.htmlDialog.getBoundingClientRect(),n=t.top+t.height,r=t.left+t.width;(e.clientY<t.top||e.clientY>n||e.clientX<t.left||e.clientX>r)&&i.htmlDialog.close()}),$(this,"onTimerChange",function(e){/^\d+$/.test(i.timerInput.value)?i.timerInput.style.borderColor="#888":i.timerInput.style.borderColor="#F22"}),$(this,"onTimerButtonClicked",function(e){/^\d+$/.test(i.timerInput.value)&&(i.timerInput.style.borderColor="#2F2",i.dialogButton.removeAttribute("timeout"),i.logic.timeout=Date.now()+Number.parseInt(i.timerInput.value),localStorage.setItem("timeout",i.logic.timeout.toString()))}),$(this,"onMoveSpeedChanged",function(e){var t=e.target.value;i.moveSpeedLabel.textContent=t,i.logic.moveSpeed=Number.parseFloat(t),localStorage.setItem("moveSpeed",t)}),$(this,"onMouseSensitivtyChanged",function(e){var t=e.target.value;i.mouseSensitivtyLabel.textContent=t,i.logic.mouseSensitivity=Number.parseFloat(t),localStorage.setItem("mouseSensitivity",t)}),this.logic=t,this.dialogButton=n,this.htmlDialog=r,this.dialogButton.onclick=this.onDialogButton,this.htmlDialog.onclick=this.onDialogClicked;var o=this.htmlDialog.children[0].children[0],a=o.children[0];this.timerInput=a.children[1],this.timerInput.onchange=this.onTimerChange,this.timerButton=a.children[2],this.timerButton.onclick=this.onTimerButtonClicked;var s=o.children[1];this.moveSpeedInput=s.children[1],this.moveSpeedInput.oninput=this.onMoveSpeedChanged,this.moveSpeedLabel=s.children[2];var u=o.children[2];this.mouseSensitivtyInput=u.children[1],this.mouseSensitivtyInput.oninput=this.onMouseSensitivtyChanged,this.mouseSensitivtyLabel=u.children[2],this.moveSpeedInput.value=t.moveSpeed.toString(),this.moveSpeedLabel.textContent=this.moveSpeedInput.value,this.mouseSensitivtyInput.value=t.mouseSensitivity.toString(),this.mouseSensitivtyLabel.textContent=this.mouseSensitivtyInput.value};function et(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,i)}function en(){var e;return e=function(){var e,t,n,r;return function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,function(i){switch(i.label){case 0:return e=document.querySelector("canvas"),t=document.querySelector("svg"),n=document.querySelector("dialog"),[4,X.create(e)];case 1:return new Q(r=new W(i.sent(),e,t),e),new ee(r,t,n),[2]}})},(en=function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){et(o,r,i,a,s,"next",e)}function s(e){et(o,r,i,a,s,"throw",e)}a(void 0)})}).apply(this,arguments)}!function(){en.apply(this,arguments)}()})();